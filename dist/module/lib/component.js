/* grapper - 1.0.0-beta.1 [module:component] */ var cn="function",ue="undefined",S="object",L="string",W="array",O="number",k="boolean",an="date",un="symbol";var H=(t,e)=>typeof t===e,J=(t,e)=>t instanceof e,y=t=>H(t,S),N=t=>H(t,L),f=t=>H(t,cn),le=t=>H(t,O)&&!isNaN(t),ot=t=>!Number.isNaN(t),g=t=>H(t,ue),fe=t=>H(t,un),he=t=>H(t,k),I=t=>Array.isArray(t),Mt=t=>J(t,Date)&&!isNaN(t),T=t=>t===null,ct=t=>t.replace(/-([a-z0-9])/g,(e,n)=>n.toUpperCase());function ln(t){if(N(t))try{return JSON.parse(`{${t.replace(/^\s*{/,"").replace(/}\s*$/,"").split(/((?:[^;^,"']|"[^"]*"|'[^']*')+)/).filter(e=>!["",";",","].includes(e.trim())).map(e=>e.split(":")).map(e=>`"${e[0].trim()}":${_(e[1].trim(),void 0,!0)}`).join(",")}}`)}catch{try{return _(t)}catch(n){console.error(n);return}}if(y(t))return t}function de(t){if(N(t))return t.trim().startsWith("[")?(t.match(/\[(.*?)[^\]]]/g)||[]).map(e=>de(e.substring(1,e.length-1))):t.split(/[,;]/).map(e=>_(e.trim()));if(I(t))return t}function _(t,e,n=!1){if(!N(t))return t;if(t=fn(t.trim()),e===W)return de(t);if(e===S)return ln(t);if(g(e)||e===O){if(g(t)||t==="")return;let r=+t;if(ot(r)||e===O)return r}if(g(e)||e===k){if(t==="true")return!0;if(t==="false")return!1;if(e===k)return t==="0"?!1:!!t}if(e===an){try{let r=new Date(t);if(ot(r.getTime()))return r}catch{}return}if(g(e)||e===L)return n?`"${t}"`:t}function fn(t){return t[0]==="'"&&t[t.length-1]==="'"||t[0]==='"'&&t[t.length-1]==='"'?t.substring(1,t.length-1):t}function at(t){return/^\s*{/.test(t)&&/}\s*$/.test(t)}function ut(t){return/^\s*\[/.test(t)&&/]\s*$/.test(t)}function lt(t){let e=[],n=t.split(/(\r\n|\r|\n)/).map(r=>r.trim()).filter(r=>r);return n.length===0?[]:n.length===1?_(n[0]):n.reduce((r,i,o)=>{let c={},s=i.split(/((?:[^;^,"']|"[^"]*"|'[^']*')+)/).filter(a=>!["",";",","].includes(a.trim()));return o===0?(e=[...s.map(a=>_(a))],r):(s.forEach((a,u)=>{c[e[u]]=_(a)}),r.push(c),r)},[])}function X(t){let e=`return (${t});`,n=new Function(e)();return f(n)?n():n}var pe=new WeakSet,nt=!1,_t=(t,e)=>!y(t)||T(t)||!f(e)?t:function n(r){if(pe.has(r))return r;for(let o in r)y(r[o])&&!T(r[o])&&(r[o]=n(r[o]));let i=new Proxy(r,{get(o,c){let s=Reflect.get(r,c);return f(s)&&Mt(o)&&N(c)&&c.substring(0,3)==="set"&&f(e)&&(s=function(...a){let u=Reflect.get(o,c).apply(o,a);return!nt&&e(t),u}),Mt(o)?s.bind(o):s},set(o,c,s){let a,u=o[c]===s;return y(s)&&!T(s)?a=Reflect.set(o,c,n(s)):a=Reflect.set(o,c,s),!nt&&!u&&e(t),a},deleteProperty(o,c){let s=Reflect.deleteProperty(o,c);return!nt&&e(t),s}});return pe.add(i),i}(t);_t.stop=()=>nt=!0;_t.start=()=>nt=!1;var ft=_t;var rt=!1,ht=!0;function hn(t){return t===null?null:t.constructor?new t.constructor:{}}function B(t){if(!y(t))return t;let e=t===null?null:Object.assign(hn(t),t);for(let n in e)y(e[n])&&(e[n]=B(e[n]));return e}function me(t,e){let n=[],r=[];function i(c,s){if(T(c)||T(s))return rt;if(f(c.valueOf)&&f(s.valueOf)&&(c!==c.valueOf()||s!==s.valueOf()))return c.valueOf()===s.valueOf()&&c.constructor===s.constructor;if(n.indexOf(c)>-1&&r.indexOf(s)>-1)return ht;let a=Object.keys(c),u=Object.keys(s);if(a.length!==u.length)return rt;if(a.length>0){n.push(c),r.push(s);let d=a.length;for(;d--;){let h=a[d];if(!o(c[h],s[h]))return rt}}return ht}function o(c,s){if(c===s)return ht;let a=typeof c;return a!==typeof s?rt:a===O&&isNaN(c)&&isNaN(s)?ht:a===S?i(c,s):rt}return o(t,e)}function ye(t,e){let n=t,r=N(e)?e.split("."):e;for(let i=0;i<r.length;i++){if(g(n[r[i]]))return;n=n[r[i]]}return n}function dt(t,...e){if(typeof t!="object"||t===null)throw new TypeError("Target must be a non-null object");return e.forEach(n=>{typeof n!="object"||n===null||Object.keys(n).forEach(r=>{let i=n[r],o=t[r];i&&typeof i=="object"?((!o||typeof o!="object")&&(t[r]=Array.isArray(i)?[]:{}),dt(t[r],i)):t[r]=i})}),t}var E=Symbol(),G=Symbol(),$=Symbol(),It=Object.defineProperty;function dn(t,e,n,r=!1){if(!(t.ready===!1||!e))if(r)n?t.setAttribute(e,""):t.removeAttribute(e);else{let i=T(n)||g(n)?"":n.toString();t.hasAttribute(e)&&t.getAttribute(e)!==i&&t.setAttribute(e,i)}}function pn(t){this[E]={};let e=t;do{let n=pt.get(e);for(let r in n)if(n.hasOwnProperty(r)&&this.hasOwnProperty(r)){let i=this[r];delete this[r],this[r]=g(i)?B(n[r]):i}else r in this[E]||(this[E][r]=B(n[r]));e=Object.getPrototypeOf(e)}while(e!==HTMLElement)}function mn(){new MutationObserver(t=>{t.some(e=>!e.attributeName)&&this[$]("update"),(g(this.ready)||this.ready)&&f(this[G])&&this[G](t)}).observe(this,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}var pt=new WeakMap,K=class extends HTMLElement{constructor(){super(),pn.call(this,new.target),f(this[G])&&mn.call(this)}[$](e,n={},r=!1){return this.dispatchEvent(new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n,composed:r}))}};function yn(t,e){e.propertyName||(e.propertyName=ct(e.name)),ge(t,{...e,name:e.propertyName,attribute:e.name});let n=Object.getPrototypeOf(t),r="observedAttributes",i=Object.getOwnPropertyDescriptor(t,r),o=Object.getOwnPropertyDescriptor(n,r),c=i?i.get:void 0;It(t,r,En(t,e,n,c,i,o));let s="attributeChangedCallback",a=Object.getOwnPropertyDescriptor(t.prototype,s),u=Object.getOwnPropertyDescriptor(n.prototype,s),d=a?a.value:void 0;It(t.prototype,s,gn(e,d,u))}function gn(t,e,n){return{value:function(r,i,o){if(t.name===r){let c=t.propertyName;this[c]!==o&&(t.type===k?this[c]=this.hasAttribute(t.name):this[c]=_(o,t.type))}else e&&e.apply(this,arguments);n?.value&&n.value.apply(this,arguments)},enumerable:!1,writable:!0,configurable:!0}}function En(t,e,n,r,i,o){let c={enumerable:!1,configurable:!0};return i?o?c.get=function(){return[e.name,...r.call(t),...o.get.call(n)]}:c.get=function(){return[e.name,...r.call(t)]}:c.get=o?function(){return[e.name,...o.get.call(n)]}:function(){return[e.name]},c}function ge(t,e){It(t.prototype,e.name,{set:Ee(e),get:Nn(e),configurable:!0,enumerable:!1}),pt.has(t)||pt.set(t,{}),pt.get(t)[e.name]=e.value}function xn(t,e){T(t.posUpdateEvent)||(t.posUpdateEvent?this[$](t.posUpdateEvent,{[t.name]:e}):this[$]("update",{[t.name]:e})),f(t.posUpdate)?t.posUpdate.call(this,e):f(this[t.posUpdate])&&this[t.posUpdate]()}function Ee(t){return function(e){let n=this[E];f(t.preUpdate)&&!t.preUpdate.call(this,e)||(t.schema&&(ft.stop(),e=t.schema.normalize(e),ft.start()),!(!y(e)&&me(n[t.name],e))&&(f(t.set)?t.set.call(this,e):n[t.name]=N(e)&&t.type?_(e,t.type):e,t.attribute&&![W,S].includes(t.type)&&dn(this,t.attribute,e,t.type===k),xn.call(this,t,e)))}}function Nn(t){return function(){if(f(t.get))return t.get.call(this);{let e=this[E];switch(t.type){case O:return g(e[t.name])?void 0:Number(e[t.name]);case k:return!!e[t.name];case S:case W:return ft(e[t.name]||(t.type===S?{}:[]),n=>Ee(t).call(this,n));default:return e[t.name]}}}}function $n(t,e){e=e.toLowerCase(),customElements.get(e)||customElements.define(e,t)}function xe(t,e={}){return e.prop=(...n)=>(n.forEach(r=>ge(t,{...r})),e),e.attr=(...n)=>(n.forEach(r=>yn(t,{...r})),e),e.tag=n=>($n(t,n),e),e.extension=e.ext=n=>(n.call(e,e,t),e),e}K.CHANGE=G;K.FIRE_EVENT=$;function Pt(t,e){let n=new WeakMap;return function(...r){clearTimeout(n.get(this)),n.set(this,setTimeout(()=>{t.apply(this,r)},e))}}function Ut(t,e){let n=new WeakMap,r=[];return function(...i){return clearTimeout(n.get(this)),new Promise((o,c)=>{r.push({resolve:o,reject:c}),n.set(this,setTimeout(()=>{try{let s=t.apply(this,i);r.forEach(a=>a.resolve(s))}catch(s){r.forEach(a=>a.reject(s))}finally{r.length=0}},e))})}}function Dt(t,e){return function(...n){if(t.apply(this,n))return e.apply(this,n)}}function Ft(t,e){return function(...n){let r=t.apply(this,n);return f(r.then)?r.then(i=>e.call(this,i)||i):e.call(this,r)||r}}var Ne=1,kt=Symbol(),Ht=Symbol(),Z=Symbol(),b=Symbol(),$e=Symbol(),Vt=Symbol(),Se=(t,e)=>t[e]?.forEach(n=>f(n)&&n.apply(t)),R=class extends K{constructor(e){super(),this.attachShadow({mode:"open"}),this[E].ready=e||!1,this[E].rendered=!1,g(e)&&(this.ready=!0)}get ready(){return this[E].ready}set ready(e){let n=this[E],r=n.ready;n.ready=!!e,r===!1&&n.ready===!0&&(this[$]("ready",{ready:!0}),f(this[b])&&this[b]())}get rendered(){return this[E].rendered}set rendered(e){let n=this[E],r=n.rendered;n.rendered=!!e,r===!1&&n.rendered===!0&&this[$]("render",{rendered:!0})}connectedCallback(){let e=this.getBoundingClientRect(),n=getComputedStyle(this).flexDirection,r=()=>{let{width:i,height:o}=this.getBoundingClientRect(),c=getComputedStyle(this).flexDirection;(i!==e.width||o!==e.height||c!==n)&&(f(this[$e])&&this[$e](i,o,i-e.width,o-e.height),e={width:i,height:o},n=c,this[$]("resize",e)),this[E]._resizeObserver=window.requestAnimationFrame(r)};r(),Se(this,kt)}disconnectedCallback(){window.cancelAnimationFrame(this[E]._resizeObserver),Se(this,Ht)}};R.prototype[kt]=[];R.prototype[Ht]=[];function Sn(t,e){let n={name:e.name.startsWith("--")?e.name:`--${e.name}`,initialValue:e.initialValue??e.value??"",syntax:e.syntax??"*",inherits:e.inherits??!0};t.prototype[Vt]||(t.prototype[Vt]={}),t.prototype[Vt][n.name]=n}function wn(t){if(f(t.prototype[b])){let e=t.prototype[b];t.prototype[b]=Dt(function(){return this.rendered=!1,this.ready},Ut(Ft(async function(){return e.apply(this)},function(n){this.rendered=n!==!1,this.rendered&&f(this[Z])&&this[Z]()}),Ne))}if(f(t.prototype[Z])){let e=t.prototype[Z];t.prototype[Z]=Dt(function(n){return n&&(this[E].rendered=!0),this.ready&&this[E].rendered},Ut(Ft(async function(...n){return e.apply(this,n)},function(){this[$]("refresh")}),Ne))}}function yt(t){wn(t);let e=xe(t,{style:(...n)=>(n.forEach(r=>Sn(t,{...r})),e)});return e}R.RENDER=b;R.REFRESH=Z;R.ONCONNECT=kt;R.ONDISCONNECT=Ht;var An="intersection.enter",Tn="intersection.exit",gt=Symbol();function bn(t){let e=r=>this.dispatchEvent(new CustomEvent(r,{bubbles:!0,cancelable:!0,composed:!0})),n=!1;this[gt]&&this[gt].disconnect(),this[gt]=new IntersectionObserver(r=>{r.forEach(i=>{i.isIntersecting&&i.intersectionRatio>=t?n||(n=!0,e(An)):(n=!1,e(Tn))})},{root:null,rootMargin:"0px",threshold:Array(21).fill(0).map((r,i)=>i*.05)}),this[gt].observe(this._el||this)}var Bt=bn;var we=Symbol();function Rn(t){t.attr({name:"intersection-once-class",type:L,value:""}).attr({name:"intersection-class",type:L,value:""}).attr({name:"intersection-ratio",type:O,value:0,posUpdate:On})}var Ae=(t,e)=>e&&e.split(/\s+/).forEach(n=>t.add(n)),vn=(t,e)=>e&&e.split(/\s+/).forEach(n=>t.remove(n)),Te=(t,e)=>{e.preventDefault();let n=()=>{t.removeEventListener("render",n),t[$](e.type,e.detail,e.composed)};t.addEventListener("render",n)};function On(){let t=this[E];if(this[we])return Bt.call(this,t.intersectionRatio);this[we]=!0;let e=this.classList;this.addEventListener("intersection.enter",n=>{Ae(e,t.intersectionOnceClass),Ae(e,t.intersectionClass),this.rendered||Te(this,n)}),this.addEventListener("intersection.exit",n=>{vn(e,t.intersectionClass),this.rendered||Te(this,n)}),Bt.call(this,t.intersectionRatio)}var be=Rn;var Jt="gSVGObject",Cn="http://www.w3.org/2000/svg",Ln="svg",Gt="d",Re="transform",Ce="appendChild",Yt="insertBefore",ve="insertAdjacentElement",Le="attach",Me="innerHTML",zt=new WeakMap,qt=new Set,Mn=t=>fe(t)||t.startsWith("_")||["el","gSVG","then"].includes(t),_n=()=>Jt+Math.random().toString(32).substring(2),Xt=t=>y(t)&&!T(t)&&t[Symbol.toStringTag]===Jt,In=t=>St(document.createElementNS(Cn,t)),Et=t=>N(t)?In(t):y(t)&&t!==null?Xt(t)?t:St(t):t,Pn=t=>({content:Me,source:"outerHTML",parent:"parentElement",next:"nextElementSibling",previous:"previousElementSibling",add:Ce,addBefore:Yt})[t]||t,Un=t=>["append","before","after",Ce,Yt,ve].includes(t)?function(...e){let n=[],r=[],i=[];return t===ve?(n.push(e[0]),r.push(Et(e[1]))):t===Yt?(r.push(Et(e[0])),i.push(e[1]||this.firstChild||null)):r.push(...e.map(Et)),r.every(o=>o?._el)?(this[t](...n,...r.map(o=>o._el),...i),r.forEach(o=>o._el.dispatchEvent(new Event(Le))),r.length>1?r:r[0]):null}:null,$t=class{constructor(e){this._el=e,this.gSVG=z}get[Symbol.toStringTag](){return Jt}get el(){return this._el}attachTo(e){return(y(e)?Xt(e)?e._el:e:document.querySelector(e)).appendChild(this._el),this._el.dispatchEvent(new Event(Le)),this}id(e){return e?(this._el.setAttribute("id",e),this):this._el.id||(this._el.id=_n())}ref(){return`#${this.id()}`}url(){return`url(${this.ref()})`}parents(){let e=[],n=this;for(;n=n.parentElement();)e.push(n);return e}top(){return this.parents().pop()||this}},St=t=>{if(!y(t)||T(t))return null;if(zt.has(t))return zt.get(t);let e=new Proxy(new $t(t),{get(n,r){if(Mn(r))return n[r];if(!g(n[r]))return(...c)=>(D(e,r,c),n[r].call(e,...c));if([Gt,Re,"$"+Gt,"$"+Re].includes(r)){let c="";r[0]==="$"&&(r=r.substring(1));let a=r===Gt?Dn:Fn,u=new Proxy(d=>(D(e,r,[d]),g(d)?t.getAttribute(r):(d?t.setAttribute(r,d):t.removeAttribute(r),e)),{get(d,h){return h in d?Reflect.get(d,h):(...A)=>{if(h===Symbol.toPrimitive){let P=c;return c="",P}return c+=a(e,h,A),t?.setAttribute(r,c),u}}});return u}let i=Pn(r),o=Un(i)||t[i];return f(o)?(...c)=>{D(e,r,c);let s=o.call(t,...c);return g(s)?e:Ie(s)}:_e(t,i,e)}});return zt.set(t,e),e},_e=(t,e,n,r)=>{let i=e.replace(/_/g,"-"),o=(...c)=>{if(D(n,r?`${r}.${e}`:e,c),c.length===0){let a=t?.hasAttribute&&t.hasAttribute(i)?t.getAttribute(i):t[i];return Ie(a)}let s=c[0];if(J(t,CSSStyleDeclaration))return t[i]=s,n;if(i in t&&!qt.has(i)){let a=t[i];if(String(a)===String(s))return n;try{t[i]=s}catch{qt.add(i)}if(y(t[i])&&t[i]===s||t[i]!==a||i===Me)return n;qt.add(i)}return s!==0&&!s?t?.removeAttribute&&t.removeAttribute(i):t?.setAttribute&&t.setAttribute(i,he(s)?"":String(c)),n};return new Proxy(o,{get(c,s){let a=t[i][s];return f(a)?(...u)=>(D(n,`${e}.${s}`,u),a.call(t[i],...u)||n):_e(t[i],s,n,i)},set(c,s,a){return t[i][s]=a,!0}})},Ie=t=>J(t,HTMLCollection)||J(t,NodeList)?[...t].map(e=>St(e)):J(t,SVGElement)?St(t):N(t)?t===""||isNaN(t)?t:Number(t):t,Pe=[],D=(t,e,n,r=[])=>{for(let i of Pe)i(z,t,e,n,r)},xt={},Dn=(t,e,n)=>(D(t,`d.${e}`,n,Object.keys(xt).map(r=>`d.${r}`)),xt[e]?xt[e].apply(t,n):`${e}${n.join(",")}`),Fn=(t,e,n)=>(D(t,`transform.${e}`,n),`${e}(${n.join(",")})`);function z(t){return D(null,"",[t]),Et(g(t)?Ln:t)}z.isWrapped=Xt;var Nt=t=>e=>f(e)?e(t):Object.assign(t,e),Wt={install:Ue,extendConstructor:Nt(z),extendInstance:Nt($t.prototype),extendPath:Nt(xt),beforeEveryCall(t){f(t)&&Pe.push(t)}};Wt.extendSetup=Nt(Wt);function Ue(t){return t(Wt),z}z.install=Ue;var it=z;var Kt=new Map,Vn=/function\s+([\p{L}\p{Nl}$_][\p{L}\p{Nl}$_\p{Mn}\p{Mc}\p{Nd}\p{Pc}]*)\s*\(/gmu,kn=async function(){}.constructor;function wt(t,e,n=!1){let r=`${t.join(",")} ${e}`;if(Kt.has(r))return Kt.get(r);let i=new(n?kn:Function)(...t,e);return Kt.set(r,i),i}function De(t,e){let n=[...e.matchAll(Vn)].map(i=>i[1]);return wt(Object.keys(t),`${e}; return {${n.map(i=>`${i}: typeof ${i} === 'function' ? ${i} : undefined`)}}; `)(...Object.values(t))}var Zt="animate",Hn="path",Fe="d",Ve="transform",Be="rotate",q="translate",ke="inherit",He="finished",Bn=[Be,"skewX","skewY"],Gn=[q,"width","height","x","y","cx","cy","r","rx","ry","dx","dy"],zn=(t,e)=>["text","tspan"].includes(t)&&["x","y"].includes(e),Qt=!1;if(window.matchMedia){let t=window.matchMedia("(prefers-reduced-motion: reduce)");Qt=t.matches,t.addEventListener("change",()=>{Qt=t.matches})}var qn=t=>t.replace(/([A-Z])/g,"-$1").toLowerCase();function Yn(t,e={duration:200},n=null,r=null){let i=this.gSVG,o=l=>{let p=y(l)?{...l}:{duration:l};return Qt&&(p.duration=0),p.fill="none",p},c=l=>{l=I(l)?l:[l];let p=window.getComputedStyle(this._el),m=[],x=new Set;for(let C of l){let w={};for(let V in C){let v=ct(V);w[v]=h(C[V],v),!(v in p)||zn(this.tagName(),v)?x.add(v):v===Fe?w.d=`${Hn}("${w.d}")`:v===Ve&&(w.transform=u(w.transform))}m.push(w)}return a(x,m),m},s=[],a=(l,p)=>{if(l.size){let m=new KeyframeEffect(null,p).getKeyframes();for(let x of l){let C=i(Zt).attributeName(x).dur(et.duration+"ms").fill("freeze");if(p.length===1)C.to(p[0][x]);else{let w=[],V=[];for(let v in m){let on=m[v];x in p[v]&&(w.push(on.computedOffset),V.push(p[v][x]))}w[0]!==0&&(w.unshift(0),V.unshift(this[x]()||ke)),w[w.length-1]!==1&&(w.push(1),V.push(this[x]()||ke)),C.keyTimes(w.join(";")).values(V.join(";"))}s.push(C),C.attachTo(this),C.beginElementAt(et.delay||0)}}},u=l=>{N(l)&&(l=JSON.parse("{"+l.replace(/\s*\(\s*/g,":[").replace(/\s*\)\s*/g,"],").split(/\s*,\s*|\s.*/).join(",").replace(/(\w+):/g,'"$1":').replace(/,$/,"")+"}"));let p="";for(let m in l)if(m===Be){let x=d(l[m]);x.length>1&&(p+=`${q}(${h(x[1],q)},${h(x[2],q)}) `),p+=`${m}(${h(x[0],m)}) `,x.length>1&&(p+=`${q}(-${h(x[1],q)},-${h(x[2],q)}) `)}else p+=`${m}(${d(l[m]).map(x=>h(x,m)).join(",")}) `;return p},d=l=>I(l)?l:String(l).split(/\s+|,/),h=(l,p)=>Bn.includes(p)?l+"deg":Gn.includes(p)?l+"px":l,A=l=>N(l)?l.replace(/(deg)|(px)/g,"").trim():l,P=l=>l.replace(/(path\s*\(\s*["'])|(["']\s*\)\s*$)/g,"").trim().replace(/([a-zA-Z])\s*/g,"$1").replace(/\s+/g,","),Lt=l=>{let p=/translate\((.*)px,(.*)px\) rotate\((.*)deg\) translate\((.*)px,(.*)px\)\s+/,m=p.exec(l);return m&&Number(m[1])===Number(m[4])*-1&&Number(m[2])===Number(m[5])*-1?l=l.replace(p,`rotate(${m[3]}, ${m[1]}, ${m[2]})`):l=A(l),l},et=o(e),U=c(t),Y=this._el.animate(U,et);return Y.ready.then(()=>f(n)&&n.call(this,Y)),Y.finished.then(()=>{let l=U[U.length-1];for(let p in l){let m=qn(p);m.startsWith("text-")?this._el.style[p]=l[p]:p!=="offset"&&p in l&&this._el.setAttribute(m,m===Fe?P(l[p]):m===Ve?Lt(l[p]):A(l[p]))}s.forEach(p=>{p[He](!0);let m=this._el.querySelectorAll(Zt),x=this._el.querySelectorAll(`${Zt}[${He}]`);m.length===x.length&&m.forEach(C=>C.remove())}),f(r)&&r.call(this,Y)}),this}function Wn(t){t.extendInstance({animateTo:Yn})}var Ge=Wn;var Tt={},ze=Symbol(),Xe=Symbol(),M=Symbol(),Q=Symbol(),At=Symbol(),te=Symbol(),qe=Symbol(),jt="error",Jn="unknown",Ye='an invalid "g-for" expression',Xn="undefined",Kn="NaN (Not a Number)",bt=(t,e)=>new Error(`The expression "${t}" return ${e} value`),We="class",Je="style",Zn=(t,e,n)=>{throw new Error(t+` in ${e} `+n)},Qn=(t=>e=>t[e]||e)("attributeName attributeType baseFrequency calcMode clipPathUnits diffuseConstant edgeMode gradientTransform gradientUnits kernelMatrix kernelUnitLength lengthAdjust limitingConeAngle markerHeight markerUnits markerWidth maskContentUnits maskUnits numOctaves pathLength patternContentUnits patternTransform patternUnits pointsAtX pointsAtY pointsAtZ preserveAlpha preserveAspectRatio primitiveUnits refX refY requiredExtensions requiredFeatures specularConstant specularExponent spreadMethod startOffset stdDeviation stitchTiles surfaceScale systemLanguage tableValues targetX targetY textLength viewBox xChannelSelector yChannelSelector zoomAndPan".split(" ").reduce((t,e)=>(t[e.toLowerCase()]=e,t),{}));function Ke(t){if(!t?.el?.parentNode)return null;let e=document.createComment(" ref ");return t.parentNode().insertBefore(e,t.el),t.remove(),e[te]=t,e}function Ze(t){try{return new Function(`let ${t} = 0`),!0}catch{return!1}}function jn(t){let e=t[te];return t.parentNode.insertBefore(e.el,t),t.remove(),e}j({name:"g-content",exec(t,{expr:e,data:n,evalExpr:r}){let i={...n,$$:{fromURL:async a=>{let u=await fetch(a);if(u.status===200)return u.text();console.warn(`Failed to load URL: ${a} (${u.status})`)},element:t,currentContent:t.content}},o=r(e,i),c=new CustomEvent("load",{bubbles:!0,detail:t}),s=a=>g(a)?"":a;y(o)&&o.then?o.then(a=>{t.content(s(a)),t.dispatchEvent(c)}):(t.content(s(o)),t.dispatchEvent(c))}});j({name:"g-if",exec(t,{expr:e,data:n,evalExpr:r}){if(!r(e,n))return t[M]&&(t[M].forEach(i=>i.remove()),delete t[M]),Ke(t)}});j({name:"g-bind",alias:":",arg:!0,exec(t,{expr:e,arg:n,data:r,evalExpr:i}){n=Qn(n);let o=t._el,c={...r,$$:["d","transform"].includes(n)?t["$"+n]:{}};Object.assign(c.$$,{get element(){return t},get attribute(){return n},currentValue(){return n===We?[...o.classList]:n===Je?[...o.style].reduce((a,u)=>(a[u]=o.style[u],a),{}):t[n]()},dynamic(a,u=200,d=0){return t.animateTo((I(a)?a:[a]).map(h=>y(h)&&"offset"in h?{[n]:h.value,offset:h.offset}:{[n]:h}),{duration:u,delay:d}),qe}});let s=i(e,c);if(g(s))throw bt(e,Xn);if(n===We){let a=h=>t.classList.add(h),u=h=>t.classList.remove(h),d=h=>Object.entries(h).forEach(([A,P])=>P?a(A):u(A));if(I(s)){s.forEach(h=>N(h)?a(h):y(h)?d(h):void 0);return}if(y(s)){d(s);return}s&&a(s);return}if(n===Je){Object.entries(s).forEach(([a,u])=>t.style[a](u));return}s!==qe&&t[n](s)}});j({name:"g-on",alias:"@",arg:!0,exec(t,{expr:e,arg:n,data:r,evalExpr:i,error:o,code:c}){t[At]=t[At]||{};let s=t[At][n]=t[At][n]||new Map;s.has(e)&&t.removeEventListener(n,s.get(e));let a=function(u){try{let d=i(e,r,t);f(d)&&d.call(t,u)}catch(d){o(d.message,{directive:"g-on",argument:n,expression:e,toString(){return`g-on:${n}="${e}"`}},c)}};t.addEventListener(n,a),s.set(e,a),n==="init"&&!t[ze]&&(t[ze]=!0,t.dispatchEvent(new Event("init")))}});j({name:"g-for",tmpl:!0,exec(t,{expr:e,data:n,error:r}){t[M]=t[M]||[];let i=t.gSVG(Ke(t)),o=0;return rr(e,n,c=>{if(t[M][o])st(t[M][o],c,r,!1);else{let s=t.gSVG(t.tagName());s[Q]=t[Q].filter(a=>a.name!=="g-for"),[...t.attributes()].forEach(a=>{a.name!=="g-for"&&s.setAttribute(a.name,a.value)}),t.children().forEach(a=>{s.add(a.cloneNode(!0))}),i.before(s),st(s,c,r),s[Xe]=!0,t[M].push(s)}o++},c=>{for(;t[M].length>c.length;)t[M].pop().remove()}),!0}});function j({name:t,alias:e,arg:n,tmpl:r,exec:i}){let o=`^(${t}${n?":":""}${e?`|${e})`:")"}${n?"(.*)$":"$"}`,c=new RegExp(o,"i");Tt[t]={name:t,alias:e,arg:n,tmpl:r,exec:i,check:c}}function tr(t){for(let e in Tt){let n=Tt[e],r=n.check.exec(t);if(r){let i=r[2];return{...n,arg:i}}}}function er(t){return t.replace(/[{}()[\]]/g,"").split(",").map(e=>(e.includes(":")?e.split(":")[1].trim():e).trim())}function nr(t,e){return t[Symbol.iterator]?e==="of"?{iterator:[...t],type:W}:{type:jt}:le(t)?{iterator:Array(t<0?0:0|t).fill(0).map((n,r)=>r+(e==="of"?0:1)),type:O}:y(t)?e==="in"?{iterator:Object.entries(t).map(n=>n.reverse()),type:S}:{type:jt}:{iterator:t,type:Jn}}function Qe(t,e,n=null){let r=Object.keys(e).filter(Ze),o=wt(r,`return ( ${t} ); `).apply(n,r.map(c=>e[c]));if(!ot(o))throw bt(t,Kn);return o}function rr(t,e,n,r){let i="__$$i",o="__$$c",c="__$$f",s=t.match(/^\s*([\s\S]+?)[\s*|)}\]](of|in)[\s*|({[]([\s\S]+?)\s*$/);if(!s)throw bt(t,Ye);let[,a,u,d]=s;u=u.trim(),a=a.trim(),d=d.trim();let h=Qe(d,e)||[],{iterator:A,type:P}=nr(h,u);if(P===jt)throw bt(t,Ye);P===S&&!a.startsWith("[")&&(a=`[${a.replace(/(^\()|(\)$)/g,"")}]`);let Lt=er(a),et=a.startsWith("(")?a:`(${a})`,U=Object.keys(e).filter(Ze),Y=` ${i}.forEach(${et} => { ${o}({${U}${U.length?",":""}${Lt.join(",")}}); }); ${c}(${i}); `;return wt([...U,i,o,c],Y)(...U.map(p=>e[p]),A,n,r)}function st(t,e,n,r=!0){if(r&&t[Xe])return;let i=t.outerHTML();t[Q]=t[Q]||[];let o=t.attributes();for(let s of[...o]){let a=s.name,u=tr(a);u&&(t[Q].push({...u,expr:s.value}),t.removeAttribute(a))}let c=!1;for(let s of t[Q]){c=s.tmpl||c;try{if(s.exec(t,{...s,data:e,evalExpr:Qe,error:n,code:i}))return}catch(a){n(a.message,{directive:s.name,argument:s.arg,expression:s.expr,toString(){return`${s.name}${s.arg?":"+s.arg:""}="${s.expr}"`}},i)}}if(!c)for(let s of t.childNodes())s.el[te]?st(jn(s.el),e,n):s.el?.nodeType===1&&st(s,e,n)}function ir(t={},e=Zn){st(this,t,e),this.dispatchEvent(new Event("render"))}function sr(){return this.outerHTML().replaceAll("<!-- ref -->","")}function or(t){t.install(Ge),t.extendInstance({render:ir,source:sr}),t.extendSetup({extendTemplate:{defineDirective:j,getDirective(e){return Tt[e]}}})}var je=or;var tn=t=>Math.round(t*1e4)/1e4;function ee(t){return(t-90)*Math.PI/180}function Rt(t,e,n,r){let i=ee(r);return{x:tn(t+n*Math.cos(i)),y:tn(e+n*Math.sin(i))}}function vt(t,e,n,r,i=0){i=Math.abs(i)>=360?i%360:i,r=Math.abs(r)>360?r%360:r,r=Math.abs(r)===360?r>0?359.9:-359.9:r;let o=i+r,c=r>0?1:0,s=Math.abs(o-i)<=180?0:1,a=i<0?(360+i)%360:i,u=o<0?(360+o)%360:o,d=Rt(t,e,n,a),h=Rt(t,e,n,u);return`M${d.x},${d.y}A${n},${n},0,${s},${c},${h.x},${h.y}`}function cr(t,e,n,r,i,o=0){let c=vt(t,e,n+r/2,i,o),s=vt(t,e,n-r/2,-i,o+i);return c+"L"+s.substring(1)+"Z"}function ar(t,e,n,r,i=0){return`${vt(t,e,n,r,i)}L${t},${e}Z`}function ur(t){t.extendConstructor({polar2cartesian:Rt,degrees2radians:ee}),t.extendview&&t.extendview({polar2cartesian:Rt,degrees2radians:ee}),t.extendPath({arc:vt,barArc:cr,circleSlice:ar})}var en=ur;var re=Symbol(),ne=Symbol(),nn=(t,e,n)=>Object.defineProperty(t,e,{enumerable:!1,configurable:!0,writable:!0,value:n}),lr=(t,e)=>e===re?t:ye(t,e);function ie(t={}){if(!y(t))return t;let e={};function n(r,i,o,c){r in t||(e[r]||(e[r]={}),nn(t,r,(s=void 0,a=re)=>{if(N(s)||g(s)){if(a=s||re,a in e[r])return e[r][a];s=t}let u=s.reduce((d,h)=>{let A=lr(h,a);return g(A)?d:d===ne?A:o(d,A)},f(i)?i():i);return u=f(c)?c(u):u,t!==s&&(e[r][a]=u),u===i?0:u}),nn(t,r+"Before",(s,a)=>t[r](t.slice(0,s),a)))}return n("$min",ne,(r,i)=>i>r?r:i),n("$max",ne,(r,i)=>i<r?r:i),n("$count",0,r=>r+1),n("$sum",0,(r,i)=>i+r),n("$avg",()=>({n:0,i:0}),(r,i)=>(r.n++,r.i+=Number(i),r),r=>isNaN(r.i/r.n)?0:r.i/r.n),n("$distinct",()=>new Set,(r,i)=>(r.add(i),r),r=>[...r]),t}var fr="grapper-view",se="update",tt="svg",oe="methods",ce="config",ae="data",Ot="-src",rn=t=>`script[type=${t}],g-script[type=${t}]`,sn=["0px","auto"],hr=t=>{let e=getComputedStyle(t.el);return sn.includes(e.width)&&sn.includes(e.height)},F=class extends R{static install(e){it.install(e)}#e=null;#r=!1;#i=!1;#t=[];#n=[];#h=Pt(function(e,n){this[$](e,n)},1);#s(e,n,r,i){let o={message:e,scope:n,code:r,toString:()=>`${e}${n?` in ${n}`:""} ${r}`};i.push(o),console.warn(`Grapper view - Error: ${o}`),this.#h.call(this,"error",this.errors)}#d(e){return e.length=0,(n,r="",i="")=>this.#s(n,r,i,this.#t)}async#c(e){let n=await fetch(e);if(n.status!==200)throw new Error(`${n.statusText} (${n.status}): ${n.url}`);return n.text()}async#p(){let e=[...this.querySelectorAll(rn("plugin"))];for(let n of e){let r=n.getAttribute("src");if(r){let i=new URL(r,document.location.href);try{let o=await import(i.href);o?.default&&it.install(o.default)}catch(o){this.#s(o.message,"plugin",r,this.#n)}}}}async#a(){let e=this[E];if(this.#e=null,e.content.innerHTML="",e.svgSrc)try{e.content.innerHTML=await this.#c(e.svgSrc)}catch(r){this.#s(r.message,tt,e.svgSrc,this.#n)}else{let r=this.querySelector("template")?.content||this.querySelector(tt);r&&e.content.append(r.cloneNode(!0))}let n=e.content.querySelector(tt);return this.#e=n?it(n):null,!0}async#o(e,n){let r=this[E],i=e+"Src",o=this.querySelector(rn(e));o&&(r[i]=o.getAttribute("src"));let c=r[i]?await this.#c(r[i]).catch(s=>this.#s(s.message,e,r[i],this.#n)):o?.textContent;if(c)try{r[e]=n(c)}catch(s){this.#s(s.message,e,c,this.#n)}}#u(){return this.#o(oe,e=>De({$:this},e))}#l(){return this.#o(ce,X)}#f(){return this.#o(ae,e=>at(e)||ut(e)?X(e):lt(e))}constructor(){super();let e=this[E];this.shadowRoot.innerHTML=` <style> :host { display : inline-block; width : max-content; height : max-content; } </style><span></span>`,e.content=this.shadowRoot.querySelector("span")}[b](){return!this.load()}async[G](e){let n=[];for(let r of e){let i=r.target;if(i===this&&!r.attributeName)return this.load();if(i.tagName.toLowerCase()===tt)n.push(this.#a());else if(i.tagName==="SCRIPT"){let o={data:this.#f,methods:this.#u,config:this.#l}[i.type.toLowerCase()];o&&n.push(o())}}if(n.length)return await Promise.all(n),this.update()}async load(){return this.#r=!1,this.#n=[],await this.#p(),await Promise.all([this.#a(),this.#l(),this.#u(),this.#f()]),this.#r=!0,this[$]("load"),this.update(!0)}async update(e=!1){if(!(this.#i&&!e)&&this.#e){this.rendered=!1,this.#i=!0;let n=this[E],r=n.methods?.data?n.methods.data(ie(B(n.data))):ie(B(n.data)),i={...n.methods,...I(r)?{}:r,data:r,$:this};await this.#e.render(i,this.#d(this.#t)),hr(this.#e)&&this.#e.width("100%").height("100%"),this.#i=!1,this.rendered=!0}}get[tt](){return this.#e}get loaded(){return this.#r}get errors(){return[...this.#n,...this.#t]}get version(){return"1.0.0-beta.1"}};F.prototype.update=Pt(F.prototype.update,1);yt(F).ext(be).attr({name:tt+Ot,type:L,value:"",posUpdate:b}).attr({name:ae,type:S,value:[],posUpdate:se}).attr({name:ae+Ot,type:L,posUpdate:b}).prop({name:oe,type:S,value:{},posUpdate:se}).attr({name:oe+Ot,type:L,posUpdate:b}).attr({name:ce,type:S,value:{},posUpdate:se}).attr({name:ce+Ot,type:L,posUpdate:b}).attr({name:"value",set(t){this.data={value:t}},get(){return this.data?.value}}).tag(fr);var dr=t=>{t.extendSetup({extendview(e){f(e)?e(F.prototype):Object.assign(F.prototype,e)}})};it.install(dr).install(je).install(en);var Ct=class extends R{constructor(){super(),this.shadowRoot.addEventListener("load",e=>{this[$]("load",{...e.detail,data:this.data,config:this.config})}),this.shadowRoot.addEventListener("update",e=>{this[$]("update",{...e.detail,data:this.data,config:this.config})}),this.shadowRoot.addEventListener("render",e=>{this[$]("render",{...e.detail,data:this.data,config:this.config})}),this.#r(),this.#i()}async#e(e){let n=await fetch(e);if(n.status!==200)throw new Error(`${n.statusText} (${n.status}): ${n.url}`);return n.text()}async#r(){let e=this.querySelector("script[type=data],g-script[type=data]"),n=e?.getAttribute("src")||this.getAttribute("data-src"),r=n?await this.#e(n):e?.textContent;r&&(this.data=at(r)||ut(r)?X(r):lt(r))}async#i(){let e=this.querySelector("script[type=config],g-script[type=config]"),n=e?.getAttribute("src")||this.getAttribute("config-src"),r=n?await this.#e(n):e?.textContent;r&&(this.config=X(r))}get#t(){return this.shadowRoot.querySelector("grapper-view")}set data(e){if(this.#t?.loaded)this.#t.data=e;else{let n=()=>{this.#t.data=e,this.removeEventListener("load",n)};this.addEventListener("load",n)}}get data(){return this.#t.data}set config(e){if(this.#t?.loaded)dt(this.#t.config,e);else{let n=()=>{dt(this.#t.config,e),this.removeEventListener("load",n)};this.addEventListener("load",n)}}get config(){return this.#t.config}get loaded(){return this.#t.loaded}};yt(Ct).attr({name:"value",set(t){this.data={value:t}},get(){return this.data?.value}});function pr(t,e){let n=customElements.get(t);return n||(n=class extends Ct{constructor(){super(),this.shadowRoot.innerHTML=` <style> :host { display : inline-block; width : max-content; height : max-content; } grapper-view { width : auto; height : auto; } </style> ${e} `}},customElements.define(t,n)),n}export{pr as default};