/* grapper - 1.1.0-beta.11 [module:plugin.animateto] */ var B="function";var G="object",H="string";var $=(n,a)=>typeof n===a;var E=n=>$(n,G),h=n=>$(n,H),g=n=>$(n,B);var b=n=>Array.isArray(n);var j=n=>n.replace(/-([a-z0-9])/g,(a,p)=>p.toUpperCase());var N="animate",Y="path",w="d",_="transform",J="rotate",l="translate",I="inherit",M="finished",P=n=>/^(rotate|skewX|skewY)$/.test(n),V=n=>/^(translate|width|height|x|y|cx|cy|r|rx|ry|dx|dy)$/.test(n),W=(n,a)=>n&&/^(text|tspan)$/.test(n)&&/^([xy])$/.test(a),y=!1;if(window.matchMedia){let n=window.matchMedia("(prefers-reduced-motion: reduce)");y=n.matches,n.addEventListener("change",()=>{y=n.matches})}var Z=n=>n.replace(/([A-Z])/g,"-$1").toLowerCase();function q(n,a={duration:200},p=null,A=null){let C=this.gSVG,L=t=>{let r=E(t)?{...t}:{duration:t};return y&&(r.duration=0),r.fill="none",r},R=t=>{t=b(t)?t:[t];let r=window.getComputedStyle(this._el),i=[],e=new Set;for(let o of t){let s={};for(let u in o){let c=j(u);s[c]=f(o[u],c),!(c in r)||W(this.tagName(),c)?e.add(c):c===w?s.d=`${Y}("${s.d}")`:c===_&&(s.transform=D(s.transform))}i.push(s)}return k(e,i),i},S=[],k=(t,r)=>{if(t.size){let i=new KeyframeEffect(null,r).getKeyframes();for(let e of t){let o=C(N).attributeName(e).dur(m.duration+"ms").fill("freeze").begin("indefinite");if(r.length===1)o.to(r[0][e]);else{let s=[],u=[];for(let c in i){let z=i[c];e in r[c]&&(s.push(z.computedOffset),u.push(r[c][e]))}s[0]!==0&&(s.unshift(0),u.unshift(this[e]()||I)),s[s.length-1]!==1&&(s.push(1),u.push(this[e]()||I)),o.keyTimes(s.join(";")).values(u.join(";"))}S.push(o),o.attachTo(this),o.beginElementAt((m.delay||0)/1e3)}}},D=t=>{h(t)&&(t=JSON.parse("{"+t.trim().replace(/^(\w+)\s*\(\s*([^)]+)\s*\)\s*$/,(i,e,o)=>`"${e}": [${o.trim().split(/\s*,\s*|\s+/).map(s=>/^[-+]?\d+(?:\.\d+)?$/.test(s)?s:`"${s}"`).join(", ")}]`)+"}"));let r="";for(let i in t)if(i===J){let e=O(t[i]);e.length>1&&(r+=`${l}(${f(e[1],l)},${f(e[2],l)}) `),r+=`${i}(${f(e[0],i)}) `,e.length>1&&(r+=`${l}(-${f(e[1],l)},-${f(e[2],l)}) `)}else r+=`${i}(${O(t[i]).map(e=>f(e,i)).join(",")}) `;return r},O=t=>b(t)?t:String(t).split(/\s+|,/),f=(t,r)=>h(t)&&/deg|px/.test(t)?t:P(r)?t+"deg":V(r)?t+"px":t,T=t=>h(t)?t.replace(/(deg)|(px)/g,"").trim():t,F=t=>t.replace(/(path\s*\(\s*["'])|(["']\s*\)\s*$)/g,"").trim().replace(/([a-zA-Z])\s*/g,"$1").replace(/\s+/g,","),U=t=>{let r=/translate\((.*)px,(.*)px\) rotate\((.*)deg\) translate\((.*)px,(.*)px\)\s+/,i=r.exec(t);return i&&Number(i[1])===Number(i[4])*-1&&Number(i[2])===Number(i[5])*-1?t=t.replace(r,`rotate(${i[3]}, ${i[1]}, ${i[2]})`):t=T(t),t},m=L(a),x=R(n),d=this._el.animate(x,m);return d.ready.then(()=>g(p)&&p.call(this,d)),d.finished.then(()=>{let t=x[x.length-1];for(let e in t){let o=Z(e);o.startsWith("text-")?this._el.style[e]=t[e]:e!=="offset"&&e in t&&this._el.setAttribute(o,o===w?F(t[e]):o===_?U(t[e]):T(t[e]))}S.forEach(e=>e[M](!0));let r=this._el.querySelectorAll(N),i=this._el.querySelectorAll(`${N}[${M}]`);r.length===i.length&&r.forEach(e=>e.remove()),g(A)&&A.call(this,d)}),this}function K(n){n.extendInstance({animateTo:q})}var v=K;export{v as default};