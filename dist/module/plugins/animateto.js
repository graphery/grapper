/* grapper - 1.0.0-beta.1 [module:plugin.animateto] */ var B="function";var H="object",Y="string";var x=(r,l)=>typeof r===l;var T=r=>x(r,H),g=r=>x(r,Y),$=r=>x(r,B);var b=r=>Array.isArray(r);var j=r=>r.replace(/-([a-z0-9])/g,(l,p)=>p.toUpperCase());var N="animate",J="path",w="d",_="transform",C="rotate",a="translate",I="inherit",M="finished",P=[C,"skewX","skewY"],V=[a,"width","height","x","y","cx","cy","r","rx","ry","dx","dy"],W=(r,l)=>["text","tspan"].includes(r)&&["x","y"].includes(l),A=!1;if(window.matchMedia){let r=window.matchMedia("(prefers-reduced-motion: reduce)");A=r.matches,r.addEventListener("change",()=>{A=r.matches})}var Z=r=>r.replace(/([A-Z])/g,"-$1").toLowerCase();function q(r,l={duration:200},p=null,y=null){let L=this.gSVG,R=t=>{let e=T(t)?{...t}:{duration:t};return A&&(e.duration=0),e.fill="none",e},k=t=>{t=b(t)?t:[t];let e=window.getComputedStyle(this._el),n=[],i=new Set;for(let c of t){let s={};for(let f in c){let o=j(f);s[o]=u(c[f],o),!(o in e)||W(this.tagName(),o)?i.add(o):o===w?s.d=`${J}("${s.d}")`:o===_&&(s.transform=F(s.transform))}n.push(s)}return D(i,n),n},O=[],D=(t,e)=>{if(t.size){let n=new KeyframeEffect(null,e).getKeyframes();for(let i of t){let c=L(N).attributeName(i).dur(h.duration+"ms").fill("freeze");if(e.length===1)c.to(e[0][i]);else{let s=[],f=[];for(let o in n){let z=n[o];i in e[o]&&(s.push(z.computedOffset),f.push(e[o][i]))}s[0]!==0&&(s.unshift(0),f.unshift(this[i]()||I)),s[s.length-1]!==1&&(s.push(1),f.push(this[i]()||I)),c.keyTimes(s.join(";")).values(f.join(";"))}O.push(c),c.attachTo(this),c.beginElementAt(h.delay||0)}}},F=t=>{g(t)&&(t=JSON.parse("{"+t.replace(/\s*\(\s*/g,":[").replace(/\s*\)\s*/g,"],").split(/\s*,\s*|\s.*/).join(",").replace(/(\w+):/g,'"$1":').replace(/,$/,"")+"}"));let e="";for(let n in t)if(n===C){let i=S(t[n]);i.length>1&&(e+=`${a}(${u(i[1],a)},${u(i[2],a)}) `),e+=`${n}(${u(i[0],n)}) `,i.length>1&&(e+=`${a}(-${u(i[1],a)},-${u(i[2],a)}) `)}else e+=`${n}(${S(t[n]).map(i=>u(i,n)).join(",")}) `;return e},S=t=>b(t)?t:String(t).split(/\s+|,/),u=(t,e)=>P.includes(e)?t+"deg":V.includes(e)?t+"px":t,E=t=>g(t)?t.replace(/(deg)|(px)/g,"").trim():t,G=t=>t.replace(/(path\s*\(\s*["'])|(["']\s*\)\s*$)/g,"").trim().replace(/([a-zA-Z])\s*/g,"$1").replace(/\s+/g,","),U=t=>{let e=/translate\((.*)px,(.*)px\) rotate\((.*)deg\) translate\((.*)px,(.*)px\)\s+/,n=e.exec(t);return n&&Number(n[1])===Number(n[4])*-1&&Number(n[2])===Number(n[5])*-1?t=t.replace(e,`rotate(${n[3]}, ${n[1]}, ${n[2]})`):t=E(t),t},h=R(l),m=k(r),d=this._el.animate(m,h);return d.ready.then(()=>$(p)&&p.call(this,d)),d.finished.then(()=>{let t=m[m.length-1];for(let e in t){let n=Z(e);n.startsWith("text-")?this._el.style[e]=t[e]:e!=="offset"&&e in t&&this._el.setAttribute(n,n===w?G(t[e]):n===_?U(t[e]):E(t[e]))}O.forEach(e=>{e[M](!0);let n=this._el.querySelectorAll(N),i=this._el.querySelectorAll(`${N}[${M}]`);n.length===i.length&&n.forEach(c=>c.remove())}),$(y)&&y.call(this,d)}),this}function K(r){r.extendInstance({animateTo:q})}var v=K;export{v as default};