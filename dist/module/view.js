/* grapper - 1.1.0-beta.next [module:view] */ var mn="function",ce="undefined",A="object",k="string",W="array",O="number",V="boolean",yn="date",En="symbol";var B=(t,e)=>typeof t===e,q=(t,e)=>t instanceof e,E=t=>B(t,A),N=t=>B(t,k),f=t=>B(t,mn),ue=t=>B(t,O)&&!isNaN(t),ot=t=>!Number.isNaN(t),g=t=>B(t,ce),ae=t=>B(t,En),le=t=>B(t,V),M=t=>Array.isArray(t),bt=t=>q(t,Date)&&!isNaN(t),b=t=>t===null,ct=t=>t.replace(/-([a-z0-9])/g,(e,n)=>n.toUpperCase());function gn(t){if(N(t))try{return JSON.parse(`{${t.replace(/^\s*{/,"").replace(/}\s*$/,"").split(/((?:[^;^,"']|"[^"]*"|'[^']*')+)/).filter(e=>!["",";",","].includes(e.trim())).map(e=>e.split(":")).map(e=>`"${e[0].trim()}":${_(e[1].trim(),void 0,!0)}`).join(",")}}`)}catch{try{return _(t)}catch(n){console.error(n);return}}if(E(t))return t}function fe(t){if(N(t))return t.trim().startsWith("[")?(t.match(/\[(.*?)[^\]]]/g)||[]).map(e=>fe(e.substring(1,e.length-1))):t.split(/[,;]/).map(e=>_(e.trim()));if(M(t))return t}function _(t,e,n=!1){if(!N(t))return t;if(t=$n(t.trim()),e===W)return fe(t);if(e===A)return gn(t);if(g(e)||e===O){if(g(t)||t==="")return;let r=+t;if(ot(r)||e===O)return r}if(g(e)||e===V){if(t==="true")return!0;if(t==="false")return!1;if(e===V)return t==="0"?!1:!!t}if(e===yn){try{let r=new Date(t);if(ot(r.getTime()))return r}catch{}return}if(g(e)||e===k)return n?`"${t}"`:t}function $n(t){return t[0]==="'"&&t[t.length-1]==="'"||t[0]==='"'&&t[t.length-1]==='"'?t.substring(1,t.length-1):t}function he(t){return/^\s*{/.test(t)&&/}\s*$/.test(t)}function de(t){return/^\s*\[/.test(t)&&/]\s*$/.test(t)}function pe(t){let e=[],n=t.split(/(\r\n|\r|\n)/).map(r=>r.trim()).filter(r=>r);return n.length===0?[]:n.length===1?_(n[0]):n.reduce((r,i,o)=>{let u={},s=i.split(/((?:[^;^,"']|"[^"]*"|'[^']*')+)/).filter(c=>!["",";",","].includes(c.trim()));return o===0?(e=[...s.map(c=>_(c))],r):(s.forEach((c,l)=>{u[e[l]]=_(c)}),r.push(u),r)},[])}function Rt(t){let e=`return (${t});`,n=new Function(e)();return f(n)?n():n}var me=new WeakSet,tt=!1,Ot=(t,e)=>!E(t)||b(t)||!f(e)?t:function n(r){if(me.has(r))return r;for(let o in r)E(r[o])&&!b(r[o])&&(r[o]=n(r[o]));let i=new Proxy(r,{get(o,u){let s=Reflect.get(r,u);return f(s)&&bt(o)&&N(u)&&u.substring(0,3)==="set"&&f(e)&&(s=function(...c){let l=Reflect.get(o,u).apply(o,c);return!tt&&e(t),l}),bt(o)?s.bind(o):s},set(o,u,s){let c,l=o[u]===s;return E(s)&&!b(s)?c=Reflect.set(o,u,n(s)):c=Reflect.set(o,u,s),!tt&&!l&&e(t),c},deleteProperty(o,u){let s=Reflect.deleteProperty(o,u);return!tt&&e(t),s}});return me.add(i),i}(t);Ot.stop=()=>tt=!0;Ot.start=()=>tt=!1;var ut=Ot;var et=!1,at=!0;function Nn(t){return t===null?null:t.constructor?new t.constructor:{}}function G(t){if(!E(t))return t;let e=t===null?null:Object.assign(Nn(t),t);for(let n in e)E(e[n])&&(e[n]=G(e[n]));return e}function ye(t,e){let n=[],r=[];function i(u,s){if(b(u)||b(s))return et;if(f(u.valueOf)&&f(s.valueOf)&&(u!==u.valueOf()||s!==s.valueOf()))return u.valueOf()===s.valueOf()&&u.constructor===s.constructor;if(n.indexOf(u)>-1&&r.indexOf(s)>-1)return at;let c=Object.keys(u),l=Object.keys(s);if(c.length!==l.length)return et;if(c.length>0){n.push(u),r.push(s);let d=c.length;for(;d--;){let h=c[d];if(!o(u[h],s[h]))return et}}return at}function o(u,s){if(u===s)return at;let c=typeof u;return c!==typeof s?et:c===O&&isNaN(u)&&isNaN(s)?at:c===A?i(u,s):et}return o(t,e)}function Ee(t,e){let n=t,r=N(e)?e.split("."):e;for(let i=0;i<r.length;i++){if(g(n[r[i]]))return;n=n[r[i]]}return n}var $=Symbol(),H=Symbol(),T=Symbol(),Ct=Object.defineProperty;function Sn(t,e,n,r=!1){if(!(t.ready===!1||!e))if(r)n?t.setAttribute(e,""):t.removeAttribute(e);else{let i=b(n)||g(n)?"":n.toString();t.hasAttribute(e)&&t.getAttribute(e)!==i&&t.setAttribute(e,i)}}function xn(t){this[$]={};let e=t;do{let n=lt.get(e);for(let r in n)if(n.hasOwnProperty(r)&&this.hasOwnProperty(r)){let i=this[r];delete this[r],this[r]=g(i)?G(n[r]):i}else r in this[$]||(this[$][r]=G(n[r]));e=Object.getPrototypeOf(e)}while(e!==HTMLElement)}function An(){new MutationObserver(t=>{t.some(e=>!e.attributeName)&&this[T]("update"),(g(this.ready)||this.ready)&&f(this[H])&&this[H](t)}).observe(this,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}var lt=new WeakMap,J=class extends HTMLElement{constructor(){super(),xn.call(this,new.target),f(this[H])&&An.call(this)}[T](e,n={},r=!1){return this.dispatchEvent(new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n,composed:r}))}};function Tn(t,e){e.propertyName||(e.propertyName=ct(e.name)),$e(t,{...e,name:e.propertyName,attribute:e.name});let n=Object.getPrototypeOf(t),r="observedAttributes",i=Object.getOwnPropertyDescriptor(t,r),o=Object.getOwnPropertyDescriptor(n,r),u=i?i.get:void 0;Ct(t,r,bn(t,e,n,u,i,o));let s="attributeChangedCallback",c=Object.getOwnPropertyDescriptor(t.prototype,s),l=Object.getOwnPropertyDescriptor(n.prototype,s),d=c?c.value:void 0;Ct(t.prototype,s,wn(e,d,l))}function wn(t,e,n){return{value:function(r,i,o){if(t.name===r){let u=t.propertyName;this[u]!==o&&(t.type===V?this[u]=this.hasAttribute(t.name):this[u]=_(o,t.type))}else e&&e.apply(this,arguments);n?.value&&n.value.apply(this,arguments)},enumerable:!1,writable:!0,configurable:!0}}function bn(t,e,n,r,i,o){let u={enumerable:!1,configurable:!0};return i?o?u.get=function(){return[e.name,...r.call(t),...o.get.call(n)]}:u.get=function(){return[e.name,...r.call(t)]}:u.get=o?function(){return[e.name,...o.get.call(n)]}:function(){return[e.name]},u}function $e(t,e){Ct(t.prototype,e.name,{set:Ne(e),get:On(e),configurable:!0,enumerable:!1}),lt.has(t)||lt.set(t,{}),lt.get(t)[e.name]=e.value}function Rn(t,e){b(t.posUpdateEvent)||(t.posUpdateEvent?this[T](t.posUpdateEvent,{[t.name]:e}):this[T]("update",{[t.name]:e})),f(t.posUpdate)?t.posUpdate.call(this,e):f(this[t.posUpdate])&&this[t.posUpdate]()}function Ne(t){return function(e){let n=this[$];f(t.preUpdate)&&!t.preUpdate.call(this,e)||(t.schema&&(ut.stop(),e=t.schema.normalize(e),ut.start()),!(!E(e)&&ye(n[t.name],e))&&(f(t.set)?t.set.call(this,e):n[t.name]=N(e)&&t.type?_(e,t.type):e,t.attribute&&![W,A].includes(t.type)&&Sn(this,t.attribute,e,t.type===V),Rn.call(this,t,e)))}}function On(t){return function(){if(f(t.get))return t.get.call(this);{let e=this[$];switch(t.type){case O:return g(e[t.name])?void 0:Number(e[t.name]);case V:return!!e[t.name];case A:case W:return ut(e[t.name]||(t.type===A?{}:[]),n=>Ne(t).call(this,n));default:return e[t.name]}}}}function ge(t,e){e=e.toLowerCase(),customElements.get(e)||customElements.define(e,t)}function Se(t,e={}){return e.prop=(...n)=>(n.forEach(r=>$e(t,{...r})),e),e.attr=(...n)=>(n.forEach(r=>Tn(t,{...r})),e),e.tag=n=>(ge(t,n),e),e.alias=n=>(ge(class extends t{},n),e),e.extension=e.ext=n=>(n.call(e,e,t),e),e}J.CHANGE=H;J.FIRE_EVENT=T;function vt(t,e){let n=new WeakMap;return function(...r){clearTimeout(n.get(this)),n.set(this,setTimeout(()=>{t.apply(this,r)},e))}}function _t(t,e){let n=new WeakMap,r=[];return function(...i){return clearTimeout(n.get(this)),new Promise((o,u)=>{r.push({resolve:o,reject:u}),n.set(this,setTimeout(()=>{try{let s=t.apply(this,i);r.forEach(c=>c.resolve(s))}catch(s){r.forEach(c=>c.reject(s))}finally{r.length=0}},e))})}}function Mt(t,e){return function(...n){if(t.apply(this,n))return e.apply(this,n)}}function Lt(t,e){return function(...n){let r=t.apply(this,n);return f(r.then)?r.then(i=>e.call(this,i)||i):e.call(this,r)||r}}var xe=1,Pt=Symbol(),Dt=Symbol(),X=Symbol(),P=Symbol(),Ae=Symbol(),It=Symbol(),Te=(t,e)=>t[e]?.forEach(n=>f(n)&&n.apply(t)),C=class extends J{constructor(e){super(),this.attachShadow({mode:"open"}),this[$].ready=e||!1,this[$].rendered=!1,g(e)&&(this.ready=!0)}get ready(){return this[$].ready}set ready(e){let n=this[$],r=n.ready;n.ready=!!e,r===!1&&n.ready===!0&&(this[T]("ready",{ready:!0}),f(this[P])&&this[P]())}get rendered(){return this[$].rendered}set rendered(e){let n=this[$],r=n.rendered;n.rendered=!!e,r===!1&&n.rendered===!0&&this[T]("render",{rendered:!0})}connectedCallback(){let e=this.getBoundingClientRect(),n=getComputedStyle(this).flexDirection,r=()=>{let{width:i,height:o}=this.getBoundingClientRect(),u=getComputedStyle(this).flexDirection;(i!==e.width||o!==e.height||u!==n)&&(f(this[Ae])&&this[Ae](i,o,i-e.width,o-e.height),e={width:i,height:o},n=u,this[T]("resize",e)),this[$]._resizeObserver=window.requestAnimationFrame(r)};r(),Te(this,Pt)}disconnectedCallback(){window.cancelAnimationFrame(this[$]._resizeObserver),Te(this,Dt)}};C.prototype[Pt]=[];C.prototype[Dt]=[];function Cn(t,e){let n={name:e.name.startsWith("--")?e.name:`--${e.name}`,initialValue:e.initialValue??e.value??"",syntax:e.syntax??"*",inherits:e.inherits??!0};t.prototype[It]||(t.prototype[It]={}),t.prototype[It][n.name]=n}function vn(t){if(f(t.prototype[P])){let e=t.prototype[P];t.prototype[P]=Mt(function(){return this.rendered=!1,this.ready},_t(Lt(async function(){return e.apply(this)},function(n){this.rendered=n!==!1,this.rendered&&f(this[X])&&this[X]()}),xe))}if(f(t.prototype[X])){let e=t.prototype[X];t.prototype[X]=Mt(function(n){return n&&(this[$].rendered=!0),this.ready&&this[$].rendered},_t(Lt(async function(...n){return e.apply(this,n)},function(){this[T]("refresh")}),xe))}}function we(t){vn(t);let e=Se(t,{style:(...n)=>(n.forEach(r=>Cn(t,{...r})),e)});return e}C.RENDER=P;C.REFRESH=X;C.ONCONNECT=Pt;C.ONDISCONNECT=Dt;var _n="intersection.enter",Mn="intersection.exit",ht=Symbol();function Ln(t){let e=i=>{setTimeout(()=>(this._el||this.svg?._el||this).dispatchEvent(new CustomEvent(i,{bubbles:!0,cancelable:!0,composed:!0})),50)},n=!0,r=!1;this[ht]&&this[ht].disconnect(),this[ht]=new IntersectionObserver(i=>{i.forEach(o=>{o.isIntersecting&&o.intersectionRatio>=t?r||(r=!0,e(_n)):(r||n)&&(r=!1,e(Mn))}),n=!1},{root:null,rootMargin:"0px",threshold:Array(21).fill(0).map((i,o)=>o*.05)}),this[ht].observe(this._el||this)}var Ut=Ln;var be=Symbol();function In(t){t.attr({name:"intersection-once-class",type:k,value:""}).attr({name:"intersection-class",type:k,value:""}).attr({name:"intersection-ratio",type:O,value:0,posUpdate:Dn})}var Re=(t,e)=>e&&e.split(/\s+/).forEach(n=>t.add(n)),Pn=(t,e)=>e&&e.split(/\s+/).forEach(n=>t.remove(n)),Oe=(t,e)=>{e.preventDefault();let n=()=>{t.removeEventListener("render",n),t[T](e.type,e.detail,e.composed)};t.addEventListener("render",n)};function Dn(){let t=this[$];if(this[be])return Ut.call(this,t.intersectionRatio);this[be]=!0;let e=this.classList;this.addEventListener("intersection.enter",n=>{Re(e,t.intersectionOnceClass),Re(e,t.intersectionClass),this.rendered||Oe(this,n)}),this.addEventListener("intersection.exit",n=>{Pn(e,t.intersectionClass),this.rendered||Oe(this,n)}),Ut.call(this,t.intersectionRatio)}var Ce=In;var Ft=new Map,Un=/function\s+([\p{L}\p{Nl}$_][\p{L}\p{Nl}$_\p{Mn}\p{Mc}\p{Nd}\p{Pc}]*)\s*\(/gmu,Fn=async function(){}.constructor;function dt(t,e,n=!1){let r=`${t.join(",")} ${e}`;if(Ft.has(r))return Ft.get(r);let i=new(n?Fn:Function)(...t,e);return Ft.set(r,i),i}function ve(t,e){let n=[...e.matchAll(Un)].map(i=>i[1]);return dt(Object.keys(t),`${e}; return {${n.map(i=>`${i}: typeof ${i} === 'function' ? ${i} : undefined`)}}; `)(...Object.values(t))}var kt=Symbol(),Vt=Symbol(),_e=(t,e,n)=>Object.defineProperty(t,e,{enumerable:!1,configurable:!0,writable:!0,value:n}),Vn=(t,e)=>e===kt?t:Ee(t,e);function Bt(t={}){if(!E(t))return t;let e={};function n(r,i,o,u){r in t||(e[r]||(e[r]={}),_e(t,r,(s=void 0,c=kt)=>{if(N(s)||g(s)){if(c=s||kt,c in e[r])return e[r][c];s=t}let l=s.reduce((d,h)=>{let w=Vn(h,c);return g(w)?d:d===Vt?w:o(d,w)},f(i)?i():i);return l=f(u)?u(l):l,t!==s&&(e[r][c]=l),l===i?0:l}),_e(t,r+"Before",(s,c)=>t[r](t.slice(0,s),c)))}return n("$min",Vt,(r,i)=>i>r?r:i),n("$max",Vt,(r,i)=>i<r?r:i),n("$count",0,r=>r+1),n("$sum",0,(r,i)=>i+r),n("$avg",()=>({n:0,i:0}),(r,i)=>(r.n++,r.i+=Number(i),r),r=>isNaN(r.i/r.n)?0:r.i/r.n),n("$distinct",()=>new Set,(r,i)=>(r.add(i),r),r=>[...r]),t}var qt="gSVGObject",kn="http://www.w3.org/2000/svg",Bn="svg",Gt="d",Me="transform",Pe="appendChild",Yt="insertBefore",Le="insertAdjacentElement",De="attach",Ue="innerHTML",Ht=new WeakMap,zt=new Set,Gn=t=>ae(t)||t.startsWith("_")||["el","gSVG","then"].includes(t),Hn=()=>qt+Math.random().toString(32).substring(2),Jt=t=>E(t)&&!b(t)&&t[Symbol.toStringTag]===qt,zn=t=>gt(document.createElementNS(kn,t)),pt=t=>N(t)?zn(t):E(t)&&t!==null?Jt(t)?t:gt(t):t,Yn=t=>({content:Ue,source:"outerHTML",parent:"parentElement",next:"nextElementSibling",previous:"previousElementSibling",add:Pe,addBefore:Yt})[t]||t,Wn=t=>["append","before","after",Pe,Yt,Le].includes(t)?function(...e){let n=[],r=[],i=[];return t===Le?(n.push(e[0]),r.push(pt(e[1]))):t===Yt?(r.push(pt(e[0])),i.push(e[1]||this.firstChild||null)):r.push(...e.map(pt)),r.every(o=>o?._el)?(this[t](...n,...r.map(o=>o._el),...i),r.forEach(o=>o._el.dispatchEvent(new Event(De))),r.length>1?r:r[0]):null}:null,Et=class{constructor(e){this._el=e,this.gSVG=z}get[Symbol.toStringTag](){return qt}get el(){return this._el}attachTo(e){return(E(e)?Jt(e)?e._el:e:document.querySelector(e)).appendChild(this._el),this._el.dispatchEvent(new Event(De)),this}id(e){return e?(this._el.setAttribute("id",e),this):this._el.id||(this._el.id=Hn())}ref(){return`#${this.id()}`}url(){return`url(${this.ref()})`}parents(){let e=[],n=this;for(;n=n.parentElement();)e.push(n);return e}top(){return this.parents().pop()||this}},gt=t=>{if(!E(t)||b(t))return null;if(Ht.has(t))return Ht.get(t);let e=new Proxy(new Et(t),{get(n,r){if(Gn(r))return n[r];if(!g(n[r]))return(...u)=>(D(e,r,u),n[r].call(e,...u));if([Gt,Me,"$"+Gt,"$"+Me].includes(r)){let u="";r[0]==="$"&&(r=r.substring(1));let c=r===Gt?qn:Jn,l=new Proxy(d=>(D(e,r,[d]),g(d)?t.getAttribute(r):(d?t.setAttribute(r,d):t.removeAttribute(r),e)),{get(d,h){return h in d?Reflect.get(d,h):(...w)=>{if(h===Symbol.toPrimitive){let L=u;return u="",L}return u+=c(e,h,w),t?.setAttribute(r,u),l}}});return l}let i=Yn(r),o=Wn(i)||t[i];return f(o)?(...u)=>{D(e,r,u);let s=o.call(t,...u);return g(s)?e:Ve(s)}:Fe(t,i,e)}});return Ht.set(t,e),e},Fe=(t,e,n,r)=>{let i=e.replace(/_/g,"-"),o=(...u)=>{if(D(n,r?`${r}.${e}`:e,u),u.length===0){let c=t?.hasAttribute&&t.hasAttribute(i)?t.getAttribute(i):t[i];return Ve(c)}let s=u[0];if(q(t,CSSStyleDeclaration))return t[i]=s,n;if(i in t&&!zt.has(i)){let c=t[i];if(String(c)===String(s))return n;try{t[i]=s}catch{zt.add(i)}if(E(t[i])&&t[i]===s||t[i]!==c||i===Ue)return n;zt.add(i)}return s!==0&&!s?t?.removeAttribute&&t.removeAttribute(i):t?.setAttribute&&t.setAttribute(i,le(s)?"":String(u)),n};return new Proxy(o,{get(u,s){let c=t[i][s];return f(c)?(...l)=>(D(n,`${e}.${s}`,l),c.call(t[i],...l)||n):Fe(t[i],s,n,i)},set(u,s,c){return t[i][s]=c,!0}})},Ve=t=>q(t,HTMLCollection)||q(t,NodeList)?[...t].map(e=>gt(e)):q(t,SVGElement)?gt(t):N(t)?t===""||isNaN(t)?t:Number(t):t,ke=[],D=(t,e,n,r=[])=>{for(let i of ke)i(z,t,e,n,r)},mt={},qn=(t,e,n)=>(D(t,`d.${e}`,n,Object.keys(mt).map(r=>`d.${r}`)),mt[e]?mt[e].apply(t,n):`${e}${n.join(",")}`),Jn=(t,e,n)=>(D(t,`transform.${e}`,n),`${e}(${n.join(",")})`);function z(t){return D(null,"",[t]),pt(g(t)?Bn:t)}z.isWrapped=Jt;var yt=t=>e=>f(e)?e(t):Object.assign(t,e),Wt={install:Be,extendConstructor:yt(z),extendInstance:yt(Et.prototype),extendPath:yt(mt),beforeEveryCall(t){f(t)&&ke.push(t)}};Wt.extendSetup=yt(Wt);function Be(t){return t(Wt),z}z.install=Be;var nt=z;var Xt="animate",Xn="path",Ge="d",He="transform",Kn="rotate",K="translate",ze="inherit",Ye="finished",Zn=t=>/^(rotate|skewX|skewY)$/.test(t),Qn=t=>/^(translate|width|height|x|y|cx|cy|r|rx|ry|dx|dy)$/.test(t),jn=(t,e)=>t&&/^(text|tspan)$/.test(t)&&/^([xy])$/.test(e),Kt=!1;if(window.matchMedia){let t=window.matchMedia("(prefers-reduced-motion: reduce)");Kt=t.matches,t.addEventListener("change",()=>{Kt=t.matches})}var tr=t=>t.replace(/([A-Z])/g,"-$1").toLowerCase();function er(t,e={duration:200},n=null,r=null){let i=this.gSVG,o=a=>{let m=E(a)?{...a}:{duration:a};return Kt&&(m.duration=0),m.fill="none",m},u=a=>{a=M(a)?a:[a];let m=window.getComputedStyle(this._el),y=[],p=new Set;for(let x of a){let S={};for(let F in x){let R=ct(F);S[R]=h(x[F],R),!(R in m)||jn(this.tagName(),R)?p.add(R):R===Ge?S.d=`${Xn}("${S.d}")`:R===He&&(S.transform=l(S.transform))}y.push(S)}return c(p,y),y},s=[],c=(a,m)=>{if(a.size){let y=new KeyframeEffect(null,m).getKeyframes();for(let p of a){let x=i(Xt).attributeName(p).dur(j.duration+"ms").fill("freeze").begin("indefinite");if(m.length===1)x.to(m[0][p]);else{let S=[],F=[];for(let R in y){let pn=y[R];p in m[R]&&(S.push(pn.computedOffset),F.push(m[R][p]))}S[0]!==0&&(S.unshift(0),F.unshift(this[p]()||ze)),S[S.length-1]!==1&&(S.push(1),F.push(this[p]()||ze)),x.keyTimes(S.join(";")).values(F.join(";"))}s.push(x),x.attachTo(this),x.beginElementAt((j.delay||0)/1e3)}}},l=a=>{N(a)&&(a=JSON.parse("{"+a.trim().replace(/^(\w+)\s*\(\s*([^)]+)\s*\)\s*$/,(y,p,x)=>`"${p}": [${x.trim().split(/\s*,\s*|\s+/).map(S=>/^[-+]?\d+(?:\.\d+)?$/.test(S)?S:`"${S}"`).join(", ")}]`)+"}"));let m="";for(let y in a)if(y===Kn){let p=d(a[y]);p.length>1&&(m+=`${K}(${h(p[1],K)},${h(p[2],K)}) `),m+=`${y}(${h(p[0],y)}) `,p.length>1&&(m+=`${K}(-${h(p[1],K)},-${h(p[2],K)}) `)}else m+=`${y}(${d(a[y]).map(p=>h(p,y)).join(",")}) `;return m},d=a=>M(a)?a:String(a).split(/\s+|,/),h=(a,m)=>N(a)&&/deg|px/.test(a)?a:Zn(m)?a+"deg":Qn(m)?a+"px":a,w=a=>N(a)?a.replace(/(deg)|(px)/g,"").trim():a,L=a=>a.replace(/(path\s*\(\s*["'])|(["']\s*\)\s*$)/g,"").trim().replace(/([a-zA-Z])\s*/g,"$1").replace(/\s+/g,","),wt=a=>{let m=/translate\((.*)px,(.*)px\) rotate\((.*)deg\) translate\((.*)px,(.*)px\)\s+/,y=m.exec(a);return y&&Number(y[1])===Number(y[4])*-1&&Number(y[2])===Number(y[5])*-1?a=a.replace(m,`rotate(${y[3]}, ${y[1]}, ${y[2]})`):a=w(a),a},j=o(e),I=u(t),Y=this._el.animate(I,j);return Y.ready.then(()=>f(n)&&n.call(this,Y)),Y.finished.then(()=>{let a=I[I.length-1];for(let p in a){let x=tr(p);x.startsWith("text-")?this._el.style[p]=a[p]:p!=="offset"&&p in a&&this._el.setAttribute(x,x===Ge?L(a[p]):x===He?wt(a[p]):w(a[p]))}s.forEach(p=>p[Ye](!0));let m=this._el.querySelectorAll(Xt),y=this._el.querySelectorAll(`${Xt}[${Ye}]`);m.length===y.length&&m.forEach(p=>p.remove()),f(r)&&r.call(this,Y)}),this}function nr(t){t.extendInstance({animateTo:er})}var We=nr;var Nt={},qe=Symbol(),Qe=Symbol(),v=Symbol(),Z=Symbol(),$t=Symbol(),Qt=Symbol(),Je=Symbol(),Zt="error",rr="unknown",Xe='an invalid "g-for" expression',ir="undefined",sr="NaN (Not a Number)",St=(t,e)=>new Error(`The expression "${t}" return ${e} value`),Ke="class",Ze="style",or=(t,e,n)=>{throw new Error(t+` in ${e} `+n)},cr=(t=>e=>t[e]||e)("attributeName attributeType baseFrequency calcMode clipPathUnits diffuseConstant edgeMode gradientTransform gradientUnits kernelMatrix kernelUnitLength lengthAdjust limitingConeAngle markerHeight markerUnits markerWidth maskContentUnits maskUnits numOctaves pathLength patternContentUnits patternTransform patternUnits pointsAtX pointsAtY pointsAtZ preserveAlpha preserveAspectRatio primitiveUnits refX refY requiredExtensions requiredFeatures specularConstant specularExponent spreadMethod startOffset stdDeviation stitchTiles surfaceScale systemLanguage tableValues targetX targetY textLength viewBox xChannelSelector yChannelSelector zoomAndPan".split(" ").reduce((t,e)=>(t[e.toLowerCase()]=e,t),{}));function je(t){if(!t?.el?.parentNode)return null;let e=document.createComment(" ref ");return t.parentNode().insertBefore(e,t.el),t.remove(),e[Qt]=t,e}function tn(t){try{return new Function(`let ${t} = 0`),!0}catch{return!1}}function ur(t){let e=t[Qt];return t.parentNode.insertBefore(e.el,t),t.remove(),e}Q({name:"g-content",exec(t,{expr:e,ctx:n,evalExpr:r}){let i={...n,$$:{fromURL:async c=>{let l=await fetch(c);if(l.status===200)return l.text();console.warn(`Failed to load URL: ${c} (${l.status})`)},element:t,currentContent:t.content,...n.$||{}}};i.$=i.$$;let o=r(e,i),u=new CustomEvent("load",{bubbles:!0,detail:t}),s=c=>g(c)?"":c;E(o)&&o.then?o.then(c=>{t.content(s(c)),t.dispatchEvent(u)}):(t.content(s(o)),t.dispatchEvent(u))}});Q({name:"g-if",exec(t,{expr:e,ctx:n,evalExpr:r}){if(!r(e,n))return t[v]&&(t[v].forEach(i=>i.remove()),delete t[v]),je(t)}});Q({name:"g-bind",alias:":",arg:!0,exec(t,{expr:e,arg:n,ctx:r,evalExpr:i}){n=cr(n);let o=t._el,u={...r,$$:["d","transform"].includes(n)?t["$"+n]:{}};Object.assign(u.$$,{get element(){return t},get attribute(){return n},currentValue(){return n===Ke?[...o.classList]:n===Ze?[...o.style].reduce((c,l)=>(c[l]=o.style[l],c),{}):t[n]()},dynamic(c,l=200,d=0){return t.animateTo((M(c)?c:[c]).map(h=>E(h)&&"offset"in h?{[n]:h.value,offset:h.offset}:{[n]:h}),{duration:l,delay:d}),Je},...r.$||{}}),u.$=u.$$;let s=i(e,u);if(g(s))throw St(e,ir);if(n===Ke){let c=h=>t.classList.add(h),l=h=>t.classList.remove(h),d=h=>Object.entries(h).forEach(([w,L])=>L?c(w):l(w));if(M(s)){s.forEach(h=>N(h)?c(h):E(h)?d(h):void 0);return}if(E(s)){d(s);return}s&&c(s);return}if(n===Ze){Object.entries(s).forEach(([c,l])=>t.style[c](l));return}s!==Je&&t[n](s)}});Q({name:"g-on",alias:"@",arg:!0,exec(t,{expr:e,arg:n,ctx:r,evalExpr:i,error:o,code:u}){t[$t]=t[$t]||{};let s=t[$t][n]=t[$t][n]||new Map;s.has(e)&&t.removeEventListener(n,s.get(e));let c=function(l){try{let d=i(e,r,t);f(d)&&d.call(t,l)}catch(d){o(d.message,{directive:"g-on",argument:n,expression:e,toString(){return`g-on:${n}="${e}"`}},u)}};t.addEventListener(n,c),s.set(e,c),n==="init"&&!t[qe]&&(t[qe]=!0,t.dispatchEvent(new Event("init")))}});Q({name:"g-for",tmpl:!0,exec(t,{expr:e,ctx:n,error:r}){t[v]=t[v]||[];let i=t.gSVG(je(t)),o=0;return hr(e,n,u=>{if(t[v][o])rt(t[v][o],u,r,!1);else{let s=t.gSVG(t.tagName());s[Z]=t[Z].filter(c=>c.name!=="g-for"),[...t.attributes()].forEach(c=>{c.name!=="g-for"&&s.setAttribute(c.name,c.value)}),t.children().forEach(c=>{s.add(c.cloneNode(!0))}),i.before(s),rt(s,u,r),s[Qe]=!0,t[v].push(s)}o++},u=>{for(;t[v].length>u.length;)t[v].pop().remove()}),!0}});function Q({name:t,alias:e,arg:n,tmpl:r,exec:i}){let o=`^(${t}${n?":":""}${e?`|${e})`:")"}${n?"(.*)$":"$"}`,u=new RegExp(o,"i");Nt[t]={name:t,alias:e,arg:n,tmpl:r,exec:i,check:u}}function ar(t){for(let e in Nt){let n=Nt[e],r=n.check.exec(t);if(r){let i=r[2];return{...n,arg:i}}}}function lr(t){return t.replace(/[{}()[\]]/g,"").split(",").map(e=>(e.includes(":")?e.split(":")[1].trim():e).trim())}function fr(t,e){return t[Symbol.iterator]?e==="of"?{iterator:[...t],type:W}:{type:Zt}:ue(t)?{iterator:Array(t<0?0:0|t).fill(0).map((n,r)=>r+(e==="of"?0:1)),type:O}:E(t)?e==="in"?{iterator:Object.entries(t).map(n=>n.reverse()),type:A}:{type:Zt}:{iterator:t,type:rr}}function en(t,e,n=null){let r=Object.keys(e).filter(tn),o=dt(r,`return ( ${t} ); `).apply(n,r.map(u=>e[u]));if(!ot(o))throw St(t,sr);return o}function hr(t,e,n,r){let i="__$$i",o="__$$c",u="__$$f",s=t.match(/^\s*([\s\S]+?)[\s*|)}\]](of|in)[\s*|({[]([\s\S]+?)\s*$/);if(!s)throw St(t,Xe);let[,c,l,d]=s;l=l.trim(),c=c.trim(),d=d.trim();let h=en(d,e)||[],{iterator:w,type:L}=fr(h,l);if(L===Zt)throw St(t,Xe);L===A&&!c.startsWith("[")&&(c=`[${c.replace(/(^\()|(\)$)/g,"")}]`);let wt=lr(c),j=c.startsWith("(")?c:`(${c})`,I=Object.keys(e).filter(tn),Y=` ${i}.forEach(${j} => { ${o}({${I}${I.length?",":""}${wt.join(",")}}); }); ${u}(${i}); `;return dt([...I,i,o,u],Y)(...I.map(m=>e[m]),w,n,r)}function rt(t,e,n,r=!0){if(r&&t[Qe])return;let i=t.outerHTML();t[Z]=t[Z]||[];let o=t.attributes();for(let s of[...o]){let c=s.name,l=ar(c);l&&(t[Z].push({...l,expr:s.value}),t.removeAttribute(c))}let u=!1;for(let s of t[Z]){u=s.tmpl||u;try{if(s.exec(t,{...s,ctx:e,evalExpr:en,error:n,code:i}))return}catch(c){n(c.message,{directive:s.name,argument:s.arg,expression:s.expr,toString(){return`${s.name}${s.arg?":"+s.arg:""}="${s.expr}"`}},i)}}if(!u)for(let s of t.childNodes())s.el[Qt]?rt(ur(s.el),e,n):s.el?.nodeType===1&&rt(s,e,n)}function dr(t={},e=or){rt(this,t,e),this.dispatchEvent(new Event("render"))}function pr(){return this.outerHTML().replaceAll("<!-- ref -->","")}function mr(t){t.install(We),t.extendInstance({render:dr,source:pr}),t.extendSetup({extendTemplate:{defineDirective:Q,getDirective(e){return Nt[e]}}})}var nn=mr;var rn=t=>Math.round(t*1e4)/1e4;function jt(t){return(t-90)*Math.PI/180}function xt(t,e,n,r){let i=jt(r);return{x:rn(t+n*Math.cos(i)),y:rn(e+n*Math.sin(i))}}function At(t,e,n,r,i=0){i=Math.abs(i)>=360?i%360:i,r=Math.abs(r)>360?r%360:r,r=Math.abs(r)===360?r>0?359.9:-359.9:r;let o=i+r,u=r>0?1:0,s=Math.abs(o-i)<=180?0:1,c=i<0?(360+i)%360:i,l=o<0?(360+o)%360:o,d=xt(t,e,n,c),h=xt(t,e,n,l);return`M${d.x},${d.y}A${n},${n},0,${s},${u},${h.x},${h.y}`}function yr(t,e,n,r,i,o=0){let u=At(t,e,n+r/2,i,o),s=At(t,e,n-r/2,-i,o+i);return u+"L"+s.substring(1)+"Z"}function Er(t,e,n,r,i=0){return`${At(t,e,n,r,i)}L${t},${e}Z`}function gr(t){t.extendConstructor({polar2cartesian:xt,degrees2radians:jt}),t.extendview&&t.extendview({polar2cartesian:xt,degrees2radians:jt}),t.extendPath({arc:At,barArc:yr,circleSlice:Er})}var sn=gr;var te="update",hn="load",re="template",it="svg",ie="data",se="methods",oe="config",on="plugin",Tt="Src",ee="src",cn="safe-origin",un="same-origin",an=t=>`script[type=${t}],g-script[type=${t}]`,st=(t,e)=>t.querySelector(e),ne=(t,e)=>t?.getAttribute(e),$r=(t,e)=>t?.hasAttribute(e),ln=["0px","auto"],Nr=t=>{let e=getComputedStyle(t.el);return ln.includes(e.width)&&ln.includes(e.height)},fn=t=>({get svg(){return t.svg},get data(){return t.data},get config(){return t.config},get methods(){return t.methods},polar2cartesian:t.polar2cartesian,degrees2radians:t.degrees2radians,grapperView:t}),U=class extends C{static install(e){nt.install(e)}#t=null;#r=!1;#i=!1;#s=[];#e=[];#h=vt(function(e,n){this[T](e,n)},1);#n(e,n,r,i){let o={message:e,scope:n,code:r,toString:()=>`${e}${n?` in ${n}`:""} ${r}`};i.push(o),console.warn(`Grapper view - Error: ${o}`),this.#h.call(this,"error",this.errors)}#d(e){return e.length=0,(n,r="",i="")=>this.#n(n,r,i,this.#s)}async#c(e,n){let r=await fetch(e,n?{}:{mode:un,credentials:un});if(r.status!==200)throw new Error(`${r.statusText} (${r.status}): ${r.url}`);return r.text()}async#p(){let e=[...this.querySelectorAll(an(on))];for(let n of e){let r=ne(n,ee);if(r){let i=new URL(r,document.location.href);try{let o=await import(i.href);o?.default&&nt.install(o.default)}catch(o){this.#n(o.message,on,r,this.#e)}}}}async#u(){let e=this[$];this.#t=null,e.content.innerHTML="";let n=st(this,re);if(e.templateSrc||(e.templateSrc=ne(n,ee)),e.templateSrc)try{e.content.innerHTML=await this.#c(e.templateSrc,n?.hasAttribute(cn))}catch(i){this.#n(i.message,it,e.templateSrc,this.#e)}else{let i=n?.content||st(this,it);i&&e.content.append(i.cloneNode(!0))}let r=st(e.content,it);return this.#t=r?nt(r):null,!0}async#o(e,n){let r=this[$],i=e+"Src",o=st(this,an(e)),u=!0;o&&(r[i]=ne(o,ee),u=$r(o,cn));let s=r[i]?await this.#c(r[i],u).catch(c=>this.#n(c.message,e,r[i],this.#e)):o?.textContent;if(s)try{r[e]=n(s,!r[i])}catch(c){this.#n(c.message,e,s,this.#e)}}#a(){return this.#o(se,e=>ve({$:fn(this)},e))}#l(){return this.#o(oe,(e,n)=>n?Rt(e):JSON.parse(e))}#f(){return this.#o(ie,(e,n)=>he(e)||de(e)?n?Rt(e):JSON.parse(e):pe(e))}constructor(){super();let e=this[$];this.shadowRoot.innerHTML=` <style> :host { display : inline-block; width : max-content; height : max-content; } </style><span></span>`,e.content=st(this.shadowRoot,"span")}[P](){return!this.load()}async[H](e){let n=[];for(let r of e){let i=r.target;if(i===this&&!r.attributeName)return this.load();if([it,re].includes(i.tagName.toLowerCase()))n.push(this.#u());else if(i.tagName==="SCRIPT"){let o={data:this.#f,methods:this.#a,config:this.#l}[i.type.toLowerCase()];o&&n.push(o.bind(this)())}}if(n.length)return await Promise.all(n),this.update()}async load(){return this.#r=!1,this.#e=[],await this.#p(),await Promise.all([this.#u(),this.#l(),this.#a(),this.#f()]),this.#r=!0,this[T](hn),this.update(!0)}async update(e=!1){if(!(this.#i&&!e)&&this.#t){this.rendered=!1,this.#i=!0;let n=this[$],r=n.methods?.data?n.methods.data(Bt(G(n.data))):Bt(G(n.data)),i={...n.methods,...M(r)?{}:r,data:r,$:fn(this)};await this.#t.render(i,this.#d(this.#s)),Nr(this.#t)&&this.#t.width("100%").height("100%"),this.#i=!1,this.rendered=!0}}get[it](){return this.#t}get loaded(){return this.#r}get errors(){return[...this.#e,...this.#s]}get version(){return"1.1.0-beta.next"}};U.prototype.update=vt(U.prototype.update,1);var dn=we(U).ext(Ce).attr({name:ie,type:A,value:[],posUpdate:te}).attr({name:"value",set(t){this.data={value:t}},get(){return this.data?.value}}).attr({name:oe,type:A,value:{},posUpdate:te}).prop({name:se,type:A,value:{},posUpdate:te});[re+Tt,ie+Tt,se+Tt,oe+Tt].forEach(t=>{dn.prop({name:t,type:k,value:"",posUpdate:hn})});dn.tag("grapper-view").alias("g-composer");var Sr=t=>{t.extendSetup({extendview(e){f(e)?e(U.prototype):Object.assign(U.prototype,e)}})};nt.install(Sr).install(nn).install(sn);export{U as default};