/* grapper - 1.0.0-beta.2 [module:view] */ var sn="function",re="undefined",$="object",C="string",W="array",O="number",k="boolean",on="date",cn="symbol";var B=(t,e)=>typeof t===e,J=(t,e)=>t instanceof e,y=t=>B(t,$),x=t=>B(t,C),f=t=>B(t,sn),ie=t=>B(t,O)&&!isNaN(t),st=t=>!Number.isNaN(t),E=t=>B(t,re),se=t=>B(t,cn),oe=t=>B(t,k),I=t=>Array.isArray(t),wt=t=>J(t,Date)&&!isNaN(t),w=t=>t===null,ot=t=>t.replace(/-([a-z0-9])/g,(e,n)=>n.toUpperCase());function un(t){if(x(t))try{return JSON.parse(`{${t.replace(/^\s*{/,"").replace(/}\s*$/,"").split(/((?:[^;^,"']|"[^"]*"|'[^']*')+)/).filter(e=>!["",";",","].includes(e.trim())).map(e=>e.split(":")).map(e=>`"${e[0].trim()}":${L(e[1].trim(),void 0,!0)}`).join(",")}}`)}catch{try{return L(t)}catch(n){console.error(n);return}}if(y(t))return t}function ce(t){if(x(t))return t.trim().startsWith("[")?(t.match(/\[(.*?)[^\]]]/g)||[]).map(e=>ce(e.substring(1,e.length-1))):t.split(/[,;]/).map(e=>L(e.trim()));if(I(t))return t}function L(t,e,n=!1){if(!x(t))return t;if(t=an(t.trim()),e===W)return ce(t);if(e===$)return un(t);if(E(e)||e===O){if(E(t)||t==="")return;let r=+t;if(st(r)||e===O)return r}if(E(e)||e===k){if(t==="true")return!0;if(t==="false")return!1;if(e===k)return t==="0"?!1:!!t}if(e===on){try{let r=new Date(t);if(st(r.getTime()))return r}catch{}return}if(E(e)||e===C)return n?`"${t}"`:t}function an(t){return t[0]==="'"&&t[t.length-1]==="'"||t[0]==='"'&&t[t.length-1]==='"'?t.substring(1,t.length-1):t}function ue(t){return/^\s*{/.test(t)&&/}\s*$/.test(t)}function ae(t){return/^\s*\[/.test(t)&&/]\s*$/.test(t)}function le(t){let e=[],n=t.split(/(\r\n|\r|\n)/).map(r=>r.trim()).filter(r=>r);return n.length===0?[]:n.length===1?L(n[0]):n.reduce((r,i,o)=>{let c={},s=i.split(/((?:[^;^,"']|"[^"]*"|'[^']*')+)/).filter(u=>!["",";",","].includes(u.trim()));return o===0?(e=[...s.map(u=>L(u))],r):(s.forEach((u,a)=>{c[e[a]]=L(u)}),r.push(c),r)},[])}function bt(t){let e=`return (${t});`,n=new Function(e)();return f(n)?n():n}var fe=new WeakSet,et=!1,Rt=(t,e)=>!y(t)||w(t)||!f(e)?t:function n(r){if(fe.has(r))return r;for(let o in r)y(r[o])&&!w(r[o])&&(r[o]=n(r[o]));let i=new Proxy(r,{get(o,c){let s=Reflect.get(r,c);return f(s)&&wt(o)&&x(c)&&c.substring(0,3)==="set"&&f(e)&&(s=function(...u){let a=Reflect.get(o,c).apply(o,u);return!et&&e(t),a}),wt(o)?s.bind(o):s},set(o,c,s){let u,a=o[c]===s;return y(s)&&!w(s)?u=Reflect.set(o,c,n(s)):u=Reflect.set(o,c,s),!et&&!a&&e(t),u},deleteProperty(o,c){let s=Reflect.deleteProperty(o,c);return!et&&e(t),s}});return fe.add(i),i}(t);Rt.stop=()=>et=!0;Rt.start=()=>et=!1;var ct=Rt;var nt=!1,ut=!0;function ln(t){return t===null?null:t.constructor?new t.constructor:{}}function H(t){if(!y(t))return t;let e=t===null?null:Object.assign(ln(t),t);for(let n in e)y(e[n])&&(e[n]=H(e[n]));return e}function he(t,e){let n=[],r=[];function i(c,s){if(w(c)||w(s))return nt;if(f(c.valueOf)&&f(s.valueOf)&&(c!==c.valueOf()||s!==s.valueOf()))return c.valueOf()===s.valueOf()&&c.constructor===s.constructor;if(n.indexOf(c)>-1&&r.indexOf(s)>-1)return ut;let u=Object.keys(c),a=Object.keys(s);if(u.length!==a.length)return nt;if(u.length>0){n.push(c),r.push(s);let d=u.length;for(;d--;){let h=u[d];if(!o(c[h],s[h]))return nt}}return ut}function o(c,s){if(c===s)return ut;let u=typeof c;return u!==typeof s?nt:u===O&&isNaN(c)&&isNaN(s)?ut:u===$?i(c,s):nt}return o(t,e)}function de(t,e){let n=t,r=x(e)?e.split("."):e;for(let i=0;i<r.length;i++){if(E(n[r[i]]))return;n=n[r[i]]}return n}var g=Symbol(),G=Symbol(),S=Symbol(),Ot=Object.defineProperty;function fn(t,e,n,r=!1){if(!(t.ready===!1||!e))if(r)n?t.setAttribute(e,""):t.removeAttribute(e);else{let i=w(n)||E(n)?"":n.toString();t.hasAttribute(e)&&t.getAttribute(e)!==i&&t.setAttribute(e,i)}}function hn(t){this[g]={};let e=t;do{let n=at.get(e);for(let r in n)if(n.hasOwnProperty(r)&&this.hasOwnProperty(r)){let i=this[r];delete this[r],this[r]=E(i)?H(n[r]):i}else r in this[g]||(this[g][r]=H(n[r]));e=Object.getPrototypeOf(e)}while(e!==HTMLElement)}function dn(){new MutationObserver(t=>{t.some(e=>!e.attributeName)&&this[S]("update"),(E(this.ready)||this.ready)&&f(this[G])&&this[G](t)}).observe(this,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}var at=new WeakMap,X=class extends HTMLElement{constructor(){super(),hn.call(this,new.target),f(this[G])&&dn.call(this)}[S](e,n={},r=!1){return this.dispatchEvent(new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n,composed:r}))}};function pn(t,e){e.propertyName||(e.propertyName=ot(e.name)),pe(t,{...e,name:e.propertyName,attribute:e.name});let n=Object.getPrototypeOf(t),r="observedAttributes",i=Object.getOwnPropertyDescriptor(t,r),o=Object.getOwnPropertyDescriptor(n,r),c=i?i.get:void 0;Ot(t,r,yn(t,e,n,c,i,o));let s="attributeChangedCallback",u=Object.getOwnPropertyDescriptor(t.prototype,s),a=Object.getOwnPropertyDescriptor(n.prototype,s),d=u?u.value:void 0;Ot(t.prototype,s,mn(e,d,a))}function mn(t,e,n){return{value:function(r,i,o){if(t.name===r){let c=t.propertyName;this[c]!==o&&(t.type===k?this[c]=this.hasAttribute(t.name):this[c]=L(o,t.type))}else e&&e.apply(this,arguments);n?.value&&n.value.apply(this,arguments)},enumerable:!1,writable:!0,configurable:!0}}function yn(t,e,n,r,i,o){let c={enumerable:!1,configurable:!0};return i?o?c.get=function(){return[e.name,...r.call(t),...o.get.call(n)]}:c.get=function(){return[e.name,...r.call(t)]}:c.get=o?function(){return[e.name,...o.get.call(n)]}:function(){return[e.name]},c}function pe(t,e){Ot(t.prototype,e.name,{set:me(e),get:gn(e),configurable:!0,enumerable:!1}),at.has(t)||at.set(t,{}),at.get(t)[e.name]=e.value}function En(t,e){w(t.posUpdateEvent)||(t.posUpdateEvent?this[S](t.posUpdateEvent,{[t.name]:e}):this[S]("update",{[t.name]:e})),f(t.posUpdate)?t.posUpdate.call(this,e):f(this[t.posUpdate])&&this[t.posUpdate]()}function me(t){return function(e){let n=this[g];f(t.preUpdate)&&!t.preUpdate.call(this,e)||(t.schema&&(ct.stop(),e=t.schema.normalize(e),ct.start()),!(!y(e)&&he(n[t.name],e))&&(f(t.set)?t.set.call(this,e):n[t.name]=x(e)&&t.type?L(e,t.type):e,t.attribute&&![W,$].includes(t.type)&&fn(this,t.attribute,e,t.type===k),En.call(this,t,e)))}}function gn(t){return function(){if(f(t.get))return t.get.call(this);{let e=this[g];switch(t.type){case O:return E(e[t.name])?void 0:Number(e[t.name]);case k:return!!e[t.name];case $:case W:return ct(e[t.name]||(t.type===$?{}:[]),n=>me(t).call(this,n));default:return e[t.name]}}}}function Nn(t,e){e=e.toLowerCase(),customElements.get(e)||customElements.define(e,t)}function ye(t,e={}){return e.prop=(...n)=>(n.forEach(r=>pe(t,{...r})),e),e.attr=(...n)=>(n.forEach(r=>pn(t,{...r})),e),e.tag=n=>(Nn(t,n),e),e.extension=e.ext=n=>(n.call(e,e,t),e),e}X.CHANGE=G;X.FIRE_EVENT=S;function vt(t,e){let n=new WeakMap;return function(...r){clearTimeout(n.get(this)),n.set(this,setTimeout(()=>{t.apply(this,r)},e))}}function Ct(t,e){let n=new WeakMap,r=[];return function(...i){return clearTimeout(n.get(this)),new Promise((o,c)=>{r.push({resolve:o,reject:c}),n.set(this,setTimeout(()=>{try{let s=t.apply(this,i);r.forEach(u=>u.resolve(s))}catch(s){r.forEach(u=>u.reject(s))}finally{r.length=0}},e))})}}function Mt(t,e){return function(...n){if(t.apply(this,n))return e.apply(this,n)}}function _t(t,e){return function(...n){let r=t.apply(this,n);return f(r.then)?r.then(i=>e.call(this,i)||i):e.call(this,r)||r}}var Ee=1,It=Symbol(),Pt=Symbol(),K=Symbol(),b=Symbol(),ge=Symbol(),Lt=Symbol(),Ne=(t,e)=>t[e]?.forEach(n=>f(n)&&n.apply(t)),M=class extends X{constructor(e){super(),this.attachShadow({mode:"open"}),this[g].ready=e||!1,this[g].rendered=!1,E(e)&&(this.ready=!0)}get ready(){return this[g].ready}set ready(e){let n=this[g],r=n.ready;n.ready=!!e,r===!1&&n.ready===!0&&(this[S]("ready",{ready:!0}),f(this[b])&&this[b]())}get rendered(){return this[g].rendered}set rendered(e){let n=this[g],r=n.rendered;n.rendered=!!e,r===!1&&n.rendered===!0&&this[S]("render",{rendered:!0})}connectedCallback(){let e=this.getBoundingClientRect(),n=getComputedStyle(this).flexDirection,r=()=>{let{width:i,height:o}=this.getBoundingClientRect(),c=getComputedStyle(this).flexDirection;(i!==e.width||o!==e.height||c!==n)&&(f(this[ge])&&this[ge](i,o,i-e.width,o-e.height),e={width:i,height:o},n=c,this[S]("resize",e)),this[g]._resizeObserver=window.requestAnimationFrame(r)};r(),Ne(this,It)}disconnectedCallback(){window.cancelAnimationFrame(this[g]._resizeObserver),Ne(this,Pt)}};M.prototype[It]=[];M.prototype[Pt]=[];function xn(t,e){let n={name:e.name.startsWith("--")?e.name:`--${e.name}`,initialValue:e.initialValue??e.value??"",syntax:e.syntax??"*",inherits:e.inherits??!0};t.prototype[Lt]||(t.prototype[Lt]={}),t.prototype[Lt][n.name]=n}function $n(t){if(f(t.prototype[b])){let e=t.prototype[b];t.prototype[b]=Mt(function(){return this.rendered=!1,this.ready},Ct(_t(async function(){return e.apply(this)},function(n){this.rendered=n!==!1,this.rendered&&f(this[K])&&this[K]()}),Ee))}if(f(t.prototype[K])){let e=t.prototype[K];t.prototype[K]=Mt(function(n){return n&&(this[g].rendered=!0),this.ready&&this[g].rendered},Ct(_t(async function(...n){return e.apply(this,n)},function(){this[S]("refresh")}),Ee))}}function xe(t){$n(t);let e=ye(t,{style:(...n)=>(n.forEach(r=>xn(t,{...r})),e)});return e}M.RENDER=b;M.REFRESH=K;M.ONCONNECT=It;M.ONDISCONNECT=Pt;var Sn="intersection.enter",An="intersection.exit",ft=Symbol();function Tn(t){let e=r=>this.dispatchEvent(new CustomEvent(r,{bubbles:!0,cancelable:!0,composed:!0})),n=!1;this[ft]&&this[ft].disconnect(),this[ft]=new IntersectionObserver(r=>{r.forEach(i=>{i.isIntersecting&&i.intersectionRatio>=t?n||(n=!0,e(Sn)):(n=!1,e(An))})},{root:null,rootMargin:"0px",threshold:Array(21).fill(0).map((r,i)=>i*.05)}),this[ft].observe(this._el||this)}var Ut=Tn;var $e=Symbol();function wn(t){t.attr({name:"intersection-once-class",type:C,value:""}).attr({name:"intersection-class",type:C,value:""}).attr({name:"intersection-ratio",type:O,value:0,posUpdate:Rn})}var Se=(t,e)=>e&&e.split(/\s+/).forEach(n=>t.add(n)),bn=(t,e)=>e&&e.split(/\s+/).forEach(n=>t.remove(n)),Ae=(t,e)=>{e.preventDefault();let n=()=>{t.removeEventListener("render",n),t[S](e.type,e.detail,e.composed)};t.addEventListener("render",n)};function Rn(){let t=this[g];if(this[$e])return Ut.call(this,t.intersectionRatio);this[$e]=!0;let e=this.classList;this.addEventListener("intersection.enter",n=>{Se(e,t.intersectionOnceClass),Se(e,t.intersectionClass),this.rendered||Ae(this,n)}),this.addEventListener("intersection.exit",n=>{bn(e,t.intersectionClass),this.rendered||Ae(this,n)}),Ut.call(this,t.intersectionRatio)}var Te=wn;var Dt=new Map,On=/function\s+([\p{L}\p{Nl}$_][\p{L}\p{Nl}$_\p{Mn}\p{Mc}\p{Nd}\p{Pc}]*)\s*\(/gmu,vn=async function(){}.constructor;function ht(t,e,n=!1){let r=`${t.join(",")} ${e}`;if(Dt.has(r))return Dt.get(r);let i=new(n?vn:Function)(...t,e);return Dt.set(r,i),i}function we(t,e){let n=[...e.matchAll(On)].map(i=>i[1]);return ht(Object.keys(t),`${e}; return {${n.map(i=>`${i}: typeof ${i} === 'function' ? ${i} : undefined`)}}; `)(...Object.values(t))}var Vt=Symbol(),Ft=Symbol(),be=(t,e,n)=>Object.defineProperty(t,e,{enumerable:!1,configurable:!0,writable:!0,value:n}),Cn=(t,e)=>e===Vt?t:de(t,e);function kt(t={}){if(!y(t))return t;let e={};function n(r,i,o,c){r in t||(e[r]||(e[r]={}),be(t,r,(s=void 0,u=Vt)=>{if(x(s)||E(s)){if(u=s||Vt,u in e[r])return e[r][u];s=t}let a=s.reduce((d,h)=>{let T=Cn(h,u);return E(T)?d:d===Ft?T:o(d,T)},f(i)?i():i);return a=f(c)?c(a):a,t!==s&&(e[r][u]=a),a===i?0:a}),be(t,r+"Before",(s,u)=>t[r](t.slice(0,s),u)))}return n("$min",Ft,(r,i)=>i>r?r:i),n("$max",Ft,(r,i)=>i<r?r:i),n("$count",0,r=>r+1),n("$sum",0,(r,i)=>i+r),n("$avg",()=>({n:0,i:0}),(r,i)=>(r.n++,r.i+=Number(i),r),r=>isNaN(r.i/r.n)?0:r.i/r.n),n("$distinct",()=>new Set,(r,i)=>(r.add(i),r),r=>[...r]),t}var qt="gSVGObject",Mn="http://www.w3.org/2000/svg",_n="svg",Bt="d",Re="transform",Ce="appendChild",zt="insertBefore",Oe="insertAdjacentElement",Me="attach",_e="innerHTML",Ht=new WeakMap,Gt=new Set,Ln=t=>se(t)||t.startsWith("_")||["el","gSVG","then"].includes(t),In=()=>qt+Math.random().toString(32).substring(2),Wt=t=>y(t)&&!w(t)&&t[Symbol.toStringTag]===qt,Pn=t=>Et(document.createElementNS(Mn,t)),dt=t=>x(t)?Pn(t):y(t)&&t!==null?Wt(t)?t:Et(t):t,Un=t=>({content:_e,source:"outerHTML",parent:"parentElement",next:"nextElementSibling",previous:"previousElementSibling",add:Ce,addBefore:zt})[t]||t,Dn=t=>["append","before","after",Ce,zt,Oe].includes(t)?function(...e){let n=[],r=[],i=[];return t===Oe?(n.push(e[0]),r.push(dt(e[1]))):t===zt?(r.push(dt(e[0])),i.push(e[1]||this.firstChild||null)):r.push(...e.map(dt)),r.every(o=>o?._el)?(this[t](...n,...r.map(o=>o._el),...i),r.forEach(o=>o._el.dispatchEvent(new Event(Me))),r.length>1?r:r[0]):null}:null,yt=class{constructor(e){this._el=e,this.gSVG=z}get[Symbol.toStringTag](){return qt}get el(){return this._el}attachTo(e){return(y(e)?Wt(e)?e._el:e:document.querySelector(e)).appendChild(this._el),this._el.dispatchEvent(new Event(Me)),this}id(e){return e?(this._el.setAttribute("id",e),this):this._el.id||(this._el.id=In())}ref(){return`#${this.id()}`}url(){return`url(${this.ref()})`}parents(){let e=[],n=this;for(;n=n.parentElement();)e.push(n);return e}top(){return this.parents().pop()||this}},Et=t=>{if(!y(t)||w(t))return null;if(Ht.has(t))return Ht.get(t);let e=new Proxy(new yt(t),{get(n,r){if(Ln(r))return n[r];if(!E(n[r]))return(...c)=>(D(e,r,c),n[r].call(e,...c));if([Bt,Re,"$"+Bt,"$"+Re].includes(r)){let c="";r[0]==="$"&&(r=r.substring(1));let u=r===Bt?Fn:Vn,a=new Proxy(d=>(D(e,r,[d]),E(d)?t.getAttribute(r):(d?t.setAttribute(r,d):t.removeAttribute(r),e)),{get(d,h){return h in d?Reflect.get(d,h):(...T)=>{if(h===Symbol.toPrimitive){let P=c;return c="",P}return c+=u(e,h,T),t?.setAttribute(r,c),a}}});return a}let i=Un(r),o=Dn(i)||t[i];return f(o)?(...c)=>{D(e,r,c);let s=o.call(t,...c);return E(s)?e:Ie(s)}:Le(t,i,e)}});return Ht.set(t,e),e},Le=(t,e,n,r)=>{let i=e.replace(/_/g,"-"),o=(...c)=>{if(D(n,r?`${r}.${e}`:e,c),c.length===0){let u=t?.hasAttribute&&t.hasAttribute(i)?t.getAttribute(i):t[i];return Ie(u)}let s=c[0];if(J(t,CSSStyleDeclaration))return t[i]=s,n;if(i in t&&!Gt.has(i)){let u=t[i];if(String(u)===String(s))return n;try{t[i]=s}catch{Gt.add(i)}if(y(t[i])&&t[i]===s||t[i]!==u||i===_e)return n;Gt.add(i)}return s!==0&&!s?t?.removeAttribute&&t.removeAttribute(i):t?.setAttribute&&t.setAttribute(i,oe(s)?"":String(c)),n};return new Proxy(o,{get(c,s){let u=t[i][s];return f(u)?(...a)=>(D(n,`${e}.${s}`,a),u.call(t[i],...a)||n):Le(t[i],s,n,i)},set(c,s,u){return t[i][s]=u,!0}})},Ie=t=>J(t,HTMLCollection)||J(t,NodeList)?[...t].map(e=>Et(e)):J(t,SVGElement)?Et(t):x(t)?t===""||isNaN(t)?t:Number(t):t,Pe=[],D=(t,e,n,r=[])=>{for(let i of Pe)i(z,t,e,n,r)},pt={},Fn=(t,e,n)=>(D(t,`d.${e}`,n,Object.keys(pt).map(r=>`d.${r}`)),pt[e]?pt[e].apply(t,n):`${e}${n.join(",")}`),Vn=(t,e,n)=>(D(t,`transform.${e}`,n),`${e}(${n.join(",")})`);function z(t){return D(null,"",[t]),dt(E(t)?_n:t)}z.isWrapped=Wt;var mt=t=>e=>f(e)?e(t):Object.assign(t,e),Yt={install:Ue,extendConstructor:mt(z),extendInstance:mt(yt.prototype),extendPath:mt(pt),beforeEveryCall(t){f(t)&&Pe.push(t)}};Yt.extendSetup=mt(Yt);function Ue(t){return t(Yt),z}z.install=Ue;var rt=z;var Jt="animate",kn="path",De="d",Fe="transform",Be="rotate",Y="translate",Ve="inherit",ke="finished",Bn=[Be,"skewX","skewY"],Hn=[Y,"width","height","x","y","cx","cy","r","rx","ry","dx","dy"],Gn=(t,e)=>["text","tspan"].includes(t)&&["x","y"].includes(e),Xt=!1;if(window.matchMedia){let t=window.matchMedia("(prefers-reduced-motion: reduce)");Xt=t.matches,t.addEventListener("change",()=>{Xt=t.matches})}var zn=t=>t.replace(/([A-Z])/g,"-$1").toLowerCase();function Yn(t,e={duration:200},n=null,r=null){let i=this.gSVG,o=l=>{let p=y(l)?{...l}:{duration:l};return Xt&&(p.duration=0),p.fill="none",p},c=l=>{l=I(l)?l:[l];let p=window.getComputedStyle(this._el),m=[],N=new Set;for(let v of l){let A={};for(let V in v){let R=ot(V);A[R]=h(v[V],R),!(R in p)||Gn(this.tagName(),R)?N.add(R):R===De?A.d=`${kn}("${A.d}")`:R===Fe&&(A.transform=a(A.transform))}m.push(A)}return u(N,m),m},s=[],u=(l,p)=>{if(l.size){let m=new KeyframeEffect(null,p).getKeyframes();for(let N of l){let v=i(Jt).attributeName(N).dur(tt.duration+"ms").fill("freeze");if(p.length===1)v.to(p[0][N]);else{let A=[],V=[];for(let R in m){let rn=m[R];N in p[R]&&(A.push(rn.computedOffset),V.push(p[R][N]))}A[0]!==0&&(A.unshift(0),V.unshift(this[N]()||Ve)),A[A.length-1]!==1&&(A.push(1),V.push(this[N]()||Ve)),v.keyTimes(A.join(";")).values(V.join(";"))}s.push(v),v.attachTo(this),v.beginElementAt(tt.delay||0)}}},a=l=>{x(l)&&(l=JSON.parse("{"+l.replace(/\s*\(\s*/g,":[").replace(/\s*\)\s*/g,"],").split(/\s*,\s*|\s.*/).join(",").replace(/(\w+):/g,'"$1":').replace(/,$/,"")+"}"));let p="";for(let m in l)if(m===Be){let N=d(l[m]);N.length>1&&(p+=`${Y}(${h(N[1],Y)},${h(N[2],Y)}) `),p+=`${m}(${h(N[0],m)}) `,N.length>1&&(p+=`${Y}(-${h(N[1],Y)},-${h(N[2],Y)}) `)}else p+=`${m}(${d(l[m]).map(N=>h(N,m)).join(",")}) `;return p},d=l=>I(l)?l:String(l).split(/\s+|,/),h=(l,p)=>Bn.includes(p)?l+"deg":Hn.includes(p)?l+"px":l,T=l=>x(l)?l.replace(/(deg)|(px)/g,"").trim():l,P=l=>l.replace(/(path\s*\(\s*["'])|(["']\s*\)\s*$)/g,"").trim().replace(/([a-zA-Z])\s*/g,"$1").replace(/\s+/g,","),Tt=l=>{let p=/translate\((.*)px,(.*)px\) rotate\((.*)deg\) translate\((.*)px,(.*)px\)\s+/,m=p.exec(l);return m&&Number(m[1])===Number(m[4])*-1&&Number(m[2])===Number(m[5])*-1?l=l.replace(p,`rotate(${m[3]}, ${m[1]}, ${m[2]})`):l=T(l),l},tt=o(e),U=c(t),q=this._el.animate(U,tt);return q.ready.then(()=>f(n)&&n.call(this,q)),q.finished.then(()=>{let l=U[U.length-1];for(let p in l){let m=zn(p);m.startsWith("text-")?this._el.style[p]=l[p]:p!=="offset"&&p in l&&this._el.setAttribute(m,m===De?P(l[p]):m===Fe?Tt(l[p]):T(l[p]))}s.forEach(p=>{p[ke](!0);let m=this._el.querySelectorAll(Jt),N=this._el.querySelectorAll(`${Jt}[${ke}]`);m.length===N.length&&m.forEach(v=>v.remove())}),f(r)&&r.call(this,q)}),this}function qn(t){t.extendInstance({animateTo:Yn})}var He=qn;var Nt={},Ge=Symbol(),Je=Symbol(),_=Symbol(),Z=Symbol(),gt=Symbol(),Zt=Symbol(),ze=Symbol(),Kt="error",Wn="unknown",Ye='an invalid "g-for" expression',Jn="undefined",Xn="NaN (Not a Number)",xt=(t,e)=>new Error(`The expression "${t}" return ${e} value`),qe="class",We="style",Kn=(t,e,n)=>{throw new Error(t+` in ${e} `+n)},Zn=(t=>e=>t[e]||e)("attributeName attributeType baseFrequency calcMode clipPathUnits diffuseConstant edgeMode gradientTransform gradientUnits kernelMatrix kernelUnitLength lengthAdjust limitingConeAngle markerHeight markerUnits markerWidth maskContentUnits maskUnits numOctaves pathLength patternContentUnits patternTransform patternUnits pointsAtX pointsAtY pointsAtZ preserveAlpha preserveAspectRatio primitiveUnits refX refY requiredExtensions requiredFeatures specularConstant specularExponent spreadMethod startOffset stdDeviation stitchTiles surfaceScale systemLanguage tableValues targetX targetY textLength viewBox xChannelSelector yChannelSelector zoomAndPan".split(" ").reduce((t,e)=>(t[e.toLowerCase()]=e,t),{}));function Xe(t){if(!t?.el?.parentNode)return null;let e=document.createComment(" ref ");return t.parentNode().insertBefore(e,t.el),t.remove(),e[Zt]=t,e}function Ke(t){try{return new Function(`let ${t} = 0`),!0}catch{return!1}}function Qn(t){let e=t[Zt];return t.parentNode.insertBefore(e.el,t),t.remove(),e}Q({name:"g-content",exec(t,{expr:e,data:n,evalExpr:r}){let i={...n,$$:{fromURL:async u=>{let a=await fetch(u);if(a.status===200)return a.text();console.warn(`Failed to load URL: ${u} (${a.status})`)},element:t,currentContent:t.content}},o=r(e,i),c=new CustomEvent("load",{bubbles:!0,detail:t}),s=u=>E(u)?"":u;y(o)&&o.then?o.then(u=>{t.content(s(u)),t.dispatchEvent(c)}):(t.content(s(o)),t.dispatchEvent(c))}});Q({name:"g-if",exec(t,{expr:e,data:n,evalExpr:r}){if(!r(e,n))return t[_]&&(t[_].forEach(i=>i.remove()),delete t[_]),Xe(t)}});Q({name:"g-bind",alias:":",arg:!0,exec(t,{expr:e,arg:n,data:r,evalExpr:i}){n=Zn(n);let o=t._el,c={...r,$$:["d","transform"].includes(n)?t["$"+n]:{}};Object.assign(c.$$,{get element(){return t},get attribute(){return n},currentValue(){return n===qe?[...o.classList]:n===We?[...o.style].reduce((u,a)=>(u[a]=o.style[a],u),{}):t[n]()},dynamic(u,a=200,d=0){return t.animateTo((I(u)?u:[u]).map(h=>y(h)&&"offset"in h?{[n]:h.value,offset:h.offset}:{[n]:h}),{duration:a,delay:d}),ze}});let s=i(e,c);if(E(s))throw xt(e,Jn);if(n===qe){let u=h=>t.classList.add(h),a=h=>t.classList.remove(h),d=h=>Object.entries(h).forEach(([T,P])=>P?u(T):a(T));if(I(s)){s.forEach(h=>x(h)?u(h):y(h)?d(h):void 0);return}if(y(s)){d(s);return}s&&u(s);return}if(n===We){Object.entries(s).forEach(([u,a])=>t.style[u](a));return}s!==ze&&t[n](s)}});Q({name:"g-on",alias:"@",arg:!0,exec(t,{expr:e,arg:n,data:r,evalExpr:i,error:o,code:c}){t[gt]=t[gt]||{};let s=t[gt][n]=t[gt][n]||new Map;s.has(e)&&t.removeEventListener(n,s.get(e));let u=function(a){try{let d=i(e,r,t);f(d)&&d.call(t,a)}catch(d){o(d.message,{directive:"g-on",argument:n,expression:e,toString(){return`g-on:${n}="${e}"`}},c)}};t.addEventListener(n,u),s.set(e,u),n==="init"&&!t[Ge]&&(t[Ge]=!0,t.dispatchEvent(new Event("init")))}});Q({name:"g-for",tmpl:!0,exec(t,{expr:e,data:n,error:r}){t[_]=t[_]||[];let i=t.gSVG(Xe(t)),o=0;return nr(e,n,c=>{if(t[_][o])it(t[_][o],c,r,!1);else{let s=t.gSVG(t.tagName());s[Z]=t[Z].filter(u=>u.name!=="g-for"),[...t.attributes()].forEach(u=>{u.name!=="g-for"&&s.setAttribute(u.name,u.value)}),t.children().forEach(u=>{s.add(u.cloneNode(!0))}),i.before(s),it(s,c,r),s[Je]=!0,t[_].push(s)}o++},c=>{for(;t[_].length>c.length;)t[_].pop().remove()}),!0}});function Q({name:t,alias:e,arg:n,tmpl:r,exec:i}){let o=`^(${t}${n?":":""}${e?`|${e})`:")"}${n?"(.*)$":"$"}`,c=new RegExp(o,"i");Nt[t]={name:t,alias:e,arg:n,tmpl:r,exec:i,check:c}}function jn(t){for(let e in Nt){let n=Nt[e],r=n.check.exec(t);if(r){let i=r[2];return{...n,arg:i}}}}function tr(t){return t.replace(/[{}()[\]]/g,"").split(",").map(e=>(e.includes(":")?e.split(":")[1].trim():e).trim())}function er(t,e){return t[Symbol.iterator]?e==="of"?{iterator:[...t],type:W}:{type:Kt}:ie(t)?{iterator:Array(t<0?0:0|t).fill(0).map((n,r)=>r+(e==="of"?0:1)),type:O}:y(t)?e==="in"?{iterator:Object.entries(t).map(n=>n.reverse()),type:$}:{type:Kt}:{iterator:t,type:Wn}}function Ze(t,e,n=null){let r=Object.keys(e).filter(Ke),o=ht(r,`return ( ${t} ); `).apply(n,r.map(c=>e[c]));if(!st(o))throw xt(t,Xn);return o}function nr(t,e,n,r){let i="__$$i",o="__$$c",c="__$$f",s=t.match(/^\s*([\s\S]+?)[\s*|)}\]](of|in)[\s*|({[]([\s\S]+?)\s*$/);if(!s)throw xt(t,Ye);let[,u,a,d]=s;a=a.trim(),u=u.trim(),d=d.trim();let h=Ze(d,e)||[],{iterator:T,type:P}=er(h,a);if(P===Kt)throw xt(t,Ye);P===$&&!u.startsWith("[")&&(u=`[${u.replace(/(^\()|(\)$)/g,"")}]`);let Tt=tr(u),tt=u.startsWith("(")?u:`(${u})`,U=Object.keys(e).filter(Ke),q=` ${i}.forEach(${tt} => { ${o}({${U}${U.length?",":""}${Tt.join(",")}}); }); ${c}(${i}); `;return ht([...U,i,o,c],q)(...U.map(p=>e[p]),T,n,r)}function it(t,e,n,r=!0){if(r&&t[Je])return;let i=t.outerHTML();t[Z]=t[Z]||[];let o=t.attributes();for(let s of[...o]){let u=s.name,a=jn(u);a&&(t[Z].push({...a,expr:s.value}),t.removeAttribute(u))}let c=!1;for(let s of t[Z]){c=s.tmpl||c;try{if(s.exec(t,{...s,data:e,evalExpr:Ze,error:n,code:i}))return}catch(u){n(u.message,{directive:s.name,argument:s.arg,expression:s.expr,toString(){return`${s.name}${s.arg?":"+s.arg:""}="${s.expr}"`}},i)}}if(!c)for(let s of t.childNodes())s.el[Zt]?it(Qn(s.el),e,n):s.el?.nodeType===1&&it(s,e,n)}function rr(t={},e=Kn){it(this,t,e),this.dispatchEvent(new Event("render"))}function ir(){return this.outerHTML().replaceAll("<!-- ref -->","")}function sr(t){t.install(He),t.extendInstance({render:rr,source:ir}),t.extendSetup({extendTemplate:{defineDirective:Q,getDirective(e){return Nt[e]}}})}var Qe=sr;var je=t=>Math.round(t*1e4)/1e4;function Qt(t){return(t-90)*Math.PI/180}function $t(t,e,n,r){let i=Qt(r);return{x:je(t+n*Math.cos(i)),y:je(e+n*Math.sin(i))}}function St(t,e,n,r,i=0){i=Math.abs(i)>=360?i%360:i,r=Math.abs(r)>360?r%360:r,r=Math.abs(r)===360?r>0?359.9:-359.9:r;let o=i+r,c=r>0?1:0,s=Math.abs(o-i)<=180?0:1,u=i<0?(360+i)%360:i,a=o<0?(360+o)%360:o,d=$t(t,e,n,u),h=$t(t,e,n,a);return`M${d.x},${d.y}A${n},${n},0,${s},${c},${h.x},${h.y}`}function or(t,e,n,r,i,o=0){let c=St(t,e,n+r/2,i,o),s=St(t,e,n-r/2,-i,o+i);return c+"L"+s.substring(1)+"Z"}function cr(t,e,n,r,i=0){return`${St(t,e,n,r,i)}L${t},${e}Z`}function ur(t){t.extendConstructor({polar2cartesian:$t,degrees2radians:Qt}),t.extendview&&t.extendview({polar2cartesian:$t,degrees2radians:Qt}),t.extendPath({arc:St,barArc:or,circleSlice:cr})}var tn=ur;var ar="grapper-view",jt="update",j="svg",te="methods",ee="config",ne="data",At="-src",en=t=>`script[type=${t}],g-script[type=${t}]`,nn=["0px","auto"],lr=t=>{let e=getComputedStyle(t.el);return nn.includes(e.width)&&nn.includes(e.height)},F=class extends M{static install(e){rt.install(e)}#t=null;#r=!1;#i=!1;#s=[];#e=[];#h=vt(function(e,n){this[S](e,n)},1);#n(e,n,r,i){let o={message:e,scope:n,code:r,toString:()=>`${e}${n?` in ${n}`:""} ${r}`};i.push(o),console.warn(`Grapper view - Error: ${o}`),this.#h.call(this,"error",this.errors)}#d(e){return e.length=0,(n,r="",i="")=>this.#n(n,r,i,this.#s)}async#c(e){let n=await fetch(e);if(n.status!==200)throw new Error(`${n.statusText} (${n.status}): ${n.url}`);return n.text()}async#p(){let e=[...this.querySelectorAll(en("plugin"))];for(let n of e){let r=n.getAttribute("src");if(r){let i=new URL(r,document.location.href);try{let o=await import(i.href);o?.default&&rt.install(o.default)}catch(o){this.#n(o.message,"plugin",r,this.#e)}}}}async#u(){let e=this[g];if(this.#t=null,e.content.innerHTML="",e.svgSrc)try{e.content.innerHTML=await this.#c(e.svgSrc)}catch(r){this.#n(r.message,j,e.svgSrc,this.#e)}else{let r=this.querySelector("template")?.content||this.querySelector(j);r&&e.content.append(r.cloneNode(!0))}let n=e.content.querySelector(j);return this.#t=n?rt(n):null,!0}async#o(e,n){let r=this[g],i=e+"Src",o=this.querySelector(en(e));o&&(r[i]=o.getAttribute("src"));let c=r[i]?await this.#c(r[i]).catch(s=>this.#n(s.message,e,r[i],this.#e)):o?.textContent;if(c)try{r[e]=n(c)}catch(s){this.#n(s.message,e,c,this.#e)}}#a(){return this.#o(te,e=>we({$:this},e))}#l(){return this.#o(ee,bt)}#f(){return this.#o(ne,e=>ue(e)||ae(e)?bt(e):le(e))}constructor(){super();let e=this[g];this.shadowRoot.innerHTML=` <style> :host { display : inline-block; width : max-content; height : max-content; } </style><span></span>`,e.content=this.shadowRoot.querySelector("span")}[b](){return!this.load()}async[G](e){let n=[];for(let r of e){let i=r.target;if(i===this&&!r.attributeName)return this.load();if(i.tagName.toLowerCase()===j)n.push(this.#u());else if(i.tagName==="SCRIPT"){let o={data:this.#f,methods:this.#a,config:this.#l}[i.type.toLowerCase()];o&&n.push(o())}}if(n.length)return await Promise.all(n),this.update()}async load(){return this.#r=!1,this.#e=[],await this.#p(),await Promise.all([this.#u(),this.#l(),this.#a(),this.#f()]),this.#r=!0,this[S]("load"),this.update(!0)}async update(e=!1){if(!(this.#i&&!e)&&this.#t){this.rendered=!1,this.#i=!0;let n=this[g],r=n.methods?.data?n.methods.data(kt(H(n.data))):kt(H(n.data)),i={...n.methods,...I(r)?{}:r,data:r,$:this};await this.#t.render(i,this.#d(this.#s)),lr(this.#t)&&this.#t.width("100%").height("100%"),this.#i=!1,this.rendered=!0}}get[j](){return this.#t}get loaded(){return this.#r}get errors(){return[...this.#e,...this.#s]}get version(){return"1.0.0-beta.2"}};F.prototype.update=vt(F.prototype.update,1);xe(F).ext(Te).attr({name:j+At,type:C,value:"",posUpdate:b}).attr({name:ne,type:$,value:[],posUpdate:jt}).attr({name:ne+At,type:C,posUpdate:b}).prop({name:te,type:$,value:{},posUpdate:jt}).attr({name:te+At,type:C,posUpdate:b}).attr({name:ee,type:$,value:{},posUpdate:jt}).attr({name:ee+At,type:C,posUpdate:b}).attr({name:"value",set(t){this.data={value:t}},get(){return this.data?.value}}).tag(ar);var fr=t=>{t.extendSetup({extendview(e){f(e)?e(F.prototype):Object.assign(F.prototype,e)}})};rt.install(fr).install(Qe).install(tn);export{F as default};