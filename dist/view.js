/* grapper - 1.1.0-beta.6 [view] */ (()=>{var on="function",re="undefined",A="object",C="string",q="array",v="number",k="boolean",cn="date",un="symbol";var B=(t,e)=>typeof t===e,W=(t,e)=>t instanceof e,E=t=>B(t,A),N=t=>B(t,C),f=t=>B(t,on),ie=t=>B(t,v)&&!isNaN(t),st=t=>!Number.isNaN(t),g=t=>B(t,re),se=t=>B(t,un),oe=t=>B(t,k),I=t=>Array.isArray(t),wt=t=>W(t,Date)&&!isNaN(t),b=t=>t===null,ot=t=>t.replace(/-([a-z0-9])/g,(e,n)=>n.toUpperCase());function an(t){if(N(t))try{return JSON.parse(`{${t.replace(/^\s*{/,"").replace(/}\s*$/,"").split(/((?:[^;^,"']|"[^"]*"|'[^']*')+)/).filter(e=>!["",";",","].includes(e.trim())).map(e=>e.split(":")).map(e=>`"${e[0].trim()}":${L(e[1].trim(),void 0,!0)}`).join(",")}}`)}catch{try{return L(t)}catch(n){console.error(n);return}}if(E(t))return t}function ce(t){if(N(t))return t.trim().startsWith("[")?(t.match(/\[(.*?)[^\]]]/g)||[]).map(e=>ce(e.substring(1,e.length-1))):t.split(/[,;]/).map(e=>L(e.trim()));if(I(t))return t}function L(t,e,n=!1){if(!N(t))return t;if(t=ln(t.trim()),e===q)return ce(t);if(e===A)return an(t);if(g(e)||e===v){if(g(t)||t==="")return;let r=+t;if(st(r)||e===v)return r}if(g(e)||e===k){if(t==="true")return!0;if(t==="false")return!1;if(e===k)return t==="0"?!1:!!t}if(e===cn){try{let r=new Date(t);if(st(r.getTime()))return r}catch{}return}if(g(e)||e===C)return n?`"${t}"`:t}function ln(t){return t[0]==="'"&&t[t.length-1]==="'"||t[0]==='"'&&t[t.length-1]==='"'?t.substring(1,t.length-1):t}function ue(t){return/^\s*{/.test(t)&&/}\s*$/.test(t)}function ae(t){return/^\s*\[/.test(t)&&/]\s*$/.test(t)}function le(t){let e=[],n=t.split(/(\r\n|\r|\n)/).map(r=>r.trim()).filter(r=>r);return n.length===0?[]:n.length===1?L(n[0]):n.reduce((r,i,c)=>{let o={},s=i.split(/((?:[^;^,"']|"[^"]*"|'[^']*')+)/).filter(u=>!["",";",","].includes(u.trim()));return c===0?(e=[...s.map(u=>L(u))],r):(s.forEach((u,l)=>{o[e[l]]=L(u)}),r.push(o),r)},[])}function bt(t){let e=`return (${t});`,n=new Function(e)();return f(n)?n():n}var fe=new WeakSet,et=!1,Rt=(t,e)=>!E(t)||b(t)||!f(e)?t:function n(r){if(fe.has(r))return r;for(let c in r)E(r[c])&&!b(r[c])&&(r[c]=n(r[c]));let i=new Proxy(r,{get(c,o){let s=Reflect.get(r,o);return f(s)&&wt(c)&&N(o)&&o.substring(0,3)==="set"&&f(e)&&(s=function(...u){let l=Reflect.get(c,o).apply(c,u);return!et&&e(t),l}),wt(c)?s.bind(c):s},set(c,o,s){let u,l=c[o]===s;return E(s)&&!b(s)?u=Reflect.set(c,o,n(s)):u=Reflect.set(c,o,s),!et&&!l&&e(t),u},deleteProperty(c,o){let s=Reflect.deleteProperty(c,o);return!et&&e(t),s}});return fe.add(i),i}(t);Rt.stop=()=>et=!0;Rt.start=()=>et=!1;var ct=Rt;var nt=!1,ut=!0;function fn(t){return t===null?null:t.constructor?new t.constructor:{}}function H(t){if(!E(t))return t;let e=t===null?null:Object.assign(fn(t),t);for(let n in e)E(e[n])&&(e[n]=H(e[n]));return e}function he(t,e){let n=[],r=[];function i(o,s){if(b(o)||b(s))return nt;if(f(o.valueOf)&&f(s.valueOf)&&(o!==o.valueOf()||s!==s.valueOf()))return o.valueOf()===s.valueOf()&&o.constructor===s.constructor;if(n.indexOf(o)>-1&&r.indexOf(s)>-1)return ut;let u=Object.keys(o),l=Object.keys(s);if(u.length!==l.length)return nt;if(u.length>0){n.push(o),r.push(s);let d=u.length;for(;d--;){let h=u[d];if(!c(o[h],s[h]))return nt}}return ut}function c(o,s){if(o===s)return ut;let u=typeof o;return u!==typeof s?nt:u===v&&isNaN(o)&&isNaN(s)?ut:u===A?i(o,s):nt}return c(t,e)}function de(t,e){let n=t,r=N(e)?e.split("."):e;for(let i=0;i<r.length;i++){if(g(n[r[i]]))return;n=n[r[i]]}return n}var $=Symbol(),G=Symbol(),T=Symbol(),Ot=Object.defineProperty;function hn(t,e,n,r=!1){if(!(t.ready===!1||!e))if(r)n?t.setAttribute(e,""):t.removeAttribute(e);else{let i=b(n)||g(n)?"":n.toString();t.hasAttribute(e)&&t.getAttribute(e)!==i&&t.setAttribute(e,i)}}function dn(t){this[$]={};let e=t;do{let n=at.get(e);for(let r in n)if(n.hasOwnProperty(r)&&this.hasOwnProperty(r)){let i=this[r];delete this[r],this[r]=g(i)?H(n[r]):i}else r in this[$]||(this[$][r]=H(n[r]));e=Object.getPrototypeOf(e)}while(e!==HTMLElement)}function pn(){new MutationObserver(t=>{t.some(e=>!e.attributeName)&&this[T]("update"),(g(this.ready)||this.ready)&&f(this[G])&&this[G](t)}).observe(this,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}var at=new WeakMap,J=class extends HTMLElement{constructor(){super(),dn.call(this,new.target),f(this[G])&&pn.call(this)}[T](e,n={},r=!1){return this.dispatchEvent(new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n,composed:r}))}};function mn(t,e){e.propertyName||(e.propertyName=ot(e.name)),me(t,{...e,name:e.propertyName,attribute:e.name});let n=Object.getPrototypeOf(t),r="observedAttributes",i=Object.getOwnPropertyDescriptor(t,r),c=Object.getOwnPropertyDescriptor(n,r),o=i?i.get:void 0;Ot(t,r,En(t,e,n,o,i,c));let s="attributeChangedCallback",u=Object.getOwnPropertyDescriptor(t.prototype,s),l=Object.getOwnPropertyDescriptor(n.prototype,s),d=u?u.value:void 0;Ot(t.prototype,s,yn(e,d,l))}function yn(t,e,n){return{value:function(r,i,c){if(t.name===r){let o=t.propertyName;this[o]!==c&&(t.type===k?this[o]=this.hasAttribute(t.name):this[o]=L(c,t.type))}else e&&e.apply(this,arguments);n?.value&&n.value.apply(this,arguments)},enumerable:!1,writable:!0,configurable:!0}}function En(t,e,n,r,i,c){let o={enumerable:!1,configurable:!0};return i?c?o.get=function(){return[e.name,...r.call(t),...c.get.call(n)]}:o.get=function(){return[e.name,...r.call(t)]}:o.get=c?function(){return[e.name,...c.get.call(n)]}:function(){return[e.name]},o}function me(t,e){Ot(t.prototype,e.name,{set:ye(e),get:$n(e),configurable:!0,enumerable:!1}),at.has(t)||at.set(t,{}),at.get(t)[e.name]=e.value}function gn(t,e){b(t.posUpdateEvent)||(t.posUpdateEvent?this[T](t.posUpdateEvent,{[t.name]:e}):this[T]("update",{[t.name]:e})),f(t.posUpdate)?t.posUpdate.call(this,e):f(this[t.posUpdate])&&this[t.posUpdate]()}function ye(t){return function(e){let n=this[$];f(t.preUpdate)&&!t.preUpdate.call(this,e)||(t.schema&&(ct.stop(),e=t.schema.normalize(e),ct.start()),!(!E(e)&&he(n[t.name],e))&&(f(t.set)?t.set.call(this,e):n[t.name]=N(e)&&t.type?L(e,t.type):e,t.attribute&&![q,A].includes(t.type)&&hn(this,t.attribute,e,t.type===k),gn.call(this,t,e)))}}function $n(t){return function(){if(f(t.get))return t.get.call(this);{let e=this[$];switch(t.type){case v:return g(e[t.name])?void 0:Number(e[t.name]);case k:return!!e[t.name];case A:case q:return ct(e[t.name]||(t.type===A?{}:[]),n=>ye(t).call(this,n));default:return e[t.name]}}}}function pe(t,e){e=e.toLowerCase(),customElements.get(e)||customElements.define(e,t)}function Ee(t,e={}){return e.prop=(...n)=>(n.forEach(r=>me(t,{...r})),e),e.attr=(...n)=>(n.forEach(r=>mn(t,{...r})),e),e.tag=n=>(pe(t,n),e),e.alias=n=>(pe(class extends t{},n),e),e.extension=e.ext=n=>(n.call(e,e,t),e),e}J.CHANGE=G;J.FIRE_EVENT=T;function vt(t,e){let n=new WeakMap;return function(...r){clearTimeout(n.get(this)),n.set(this,setTimeout(()=>{t.apply(this,r)},e))}}function Ct(t,e){let n=new WeakMap,r=[];return function(...i){return clearTimeout(n.get(this)),new Promise((c,o)=>{r.push({resolve:c,reject:o}),n.set(this,setTimeout(()=>{try{let s=t.apply(this,i);r.forEach(u=>u.resolve(s))}catch(s){r.forEach(u=>u.reject(s))}finally{r.length=0}},e))})}}function Mt(t,e){return function(...n){if(t.apply(this,n))return e.apply(this,n)}}function _t(t,e){return function(...n){let r=t.apply(this,n);return f(r.then)?r.then(i=>e.call(this,i)||i):e.call(this,r)||r}}var ge=1,It=Symbol(),Pt=Symbol(),X=Symbol(),R=Symbol(),$e=Symbol(),Lt=Symbol(),Ne=(t,e)=>t[e]?.forEach(n=>f(n)&&n.apply(t)),M=class extends J{constructor(e){super(),this.attachShadow({mode:"open"}),this[$].ready=e||!1,this[$].rendered=!1,g(e)&&(this.ready=!0)}get ready(){return this[$].ready}set ready(e){let n=this[$],r=n.ready;n.ready=!!e,r===!1&&n.ready===!0&&(this[T]("ready",{ready:!0}),f(this[R])&&this[R]())}get rendered(){return this[$].rendered}set rendered(e){let n=this[$],r=n.rendered;n.rendered=!!e,r===!1&&n.rendered===!0&&this[T]("render",{rendered:!0})}connectedCallback(){let e=this.getBoundingClientRect(),n=getComputedStyle(this).flexDirection,r=()=>{let{width:i,height:c}=this.getBoundingClientRect(),o=getComputedStyle(this).flexDirection;(i!==e.width||c!==e.height||o!==n)&&(f(this[$e])&&this[$e](i,c,i-e.width,c-e.height),e={width:i,height:c},n=o,this[T]("resize",e)),this[$]._resizeObserver=window.requestAnimationFrame(r)};r(),Ne(this,It)}disconnectedCallback(){window.cancelAnimationFrame(this[$]._resizeObserver),Ne(this,Pt)}};M.prototype[It]=[];M.prototype[Pt]=[];function Nn(t,e){let n={name:e.name.startsWith("--")?e.name:`--${e.name}`,initialValue:e.initialValue??e.value??"",syntax:e.syntax??"*",inherits:e.inherits??!0};t.prototype[Lt]||(t.prototype[Lt]={}),t.prototype[Lt][n.name]=n}function xn(t){if(f(t.prototype[R])){let e=t.prototype[R];t.prototype[R]=Mt(function(){return this.rendered=!1,this.ready},Ct(_t(async function(){return e.apply(this)},function(n){this.rendered=n!==!1,this.rendered&&f(this[X])&&this[X]()}),ge))}if(f(t.prototype[X])){let e=t.prototype[X];t.prototype[X]=Mt(function(n){return n&&(this[$].rendered=!0),this.ready&&this[$].rendered},Ct(_t(async function(...n){return e.apply(this,n)},function(){this[T]("refresh")}),ge))}}function xe(t){xn(t);let e=Ee(t,{style:(...n)=>(n.forEach(r=>Nn(t,{...r})),e)});return e}M.RENDER=R;M.REFRESH=X;M.ONCONNECT=It;M.ONDISCONNECT=Pt;var Sn="intersection.enter",An="intersection.exit",ft=Symbol();function Tn(t){let e=r=>this.dispatchEvent(new CustomEvent(r,{bubbles:!0,cancelable:!0,composed:!0})),n=!1;this[ft]&&this[ft].disconnect(),this[ft]=new IntersectionObserver(r=>{r.forEach(i=>{i.isIntersecting&&i.intersectionRatio>=t?n||(n=!0,e(Sn)):(n=!1,e(An))})},{root:null,rootMargin:"0px",threshold:Array(21).fill(0).map((r,i)=>i*.05)}),this[ft].observe(this._el||this)}var Ut=Tn;var Se=Symbol();function wn(t){t.attr({name:"intersection-once-class",type:C,value:""}).attr({name:"intersection-class",type:C,value:""}).attr({name:"intersection-ratio",type:v,value:0,posUpdate:Rn})}var Ae=(t,e)=>e&&e.split(/\s+/).forEach(n=>t.add(n)),bn=(t,e)=>e&&e.split(/\s+/).forEach(n=>t.remove(n)),Te=(t,e)=>{e.preventDefault();let n=()=>{t.removeEventListener("render",n),t[T](e.type,e.detail,e.composed)};t.addEventListener("render",n)};function Rn(){let t=this[$];if(this[Se])return Ut.call(this,t.intersectionRatio);this[Se]=!0;let e=this.classList;this.addEventListener("intersection.enter",n=>{Ae(e,t.intersectionOnceClass),Ae(e,t.intersectionClass),this.rendered||Te(this,n)}),this.addEventListener("intersection.exit",n=>{bn(e,t.intersectionClass),this.rendered||Te(this,n)}),Ut.call(this,t.intersectionRatio)}var we=wn;var Dt=new Map,On=/function\s+([\p{L}\p{Nl}$_][\p{L}\p{Nl}$_\p{Mn}\p{Mc}\p{Nd}\p{Pc}]*)\s*\(/gmu,vn=async function(){}.constructor;function ht(t,e,n=!1){let r=`${t.join(",")} ${e}`;if(Dt.has(r))return Dt.get(r);let i=new(n?vn:Function)(...t,e);return Dt.set(r,i),i}function be(t,e){let n=[...e.matchAll(On)].map(i=>i[1]);return ht(Object.keys(t),`${e}; return {${n.map(i=>`${i}: typeof ${i} === 'function' ? ${i} : undefined`)}}; `)(...Object.values(t))}var Vt=Symbol(),Ft=Symbol(),Re=(t,e,n)=>Object.defineProperty(t,e,{enumerable:!1,configurable:!0,writable:!0,value:n}),Cn=(t,e)=>e===Vt?t:de(t,e);function kt(t={}){if(!E(t))return t;let e={};function n(r,i,c,o){r in t||(e[r]||(e[r]={}),Re(t,r,(s=void 0,u=Vt)=>{if(N(s)||g(s)){if(u=s||Vt,u in e[r])return e[r][u];s=t}let l=s.reduce((d,h)=>{let w=Cn(h,u);return g(w)?d:d===Ft?w:c(d,w)},f(i)?i():i);return l=f(o)?o(l):l,t!==s&&(e[r][u]=l),l===i?0:l}),Re(t,r+"Before",(s,u)=>t[r](t.slice(0,s),u)))}return n("$min",Ft,(r,i)=>i>r?r:i),n("$max",Ft,(r,i)=>i<r?r:i),n("$count",0,r=>r+1),n("$sum",0,(r,i)=>i+r),n("$avg",()=>({n:0,i:0}),(r,i)=>(r.n++,r.i+=Number(i),r),r=>isNaN(r.i/r.n)?0:r.i/r.n),n("$distinct",()=>new Set,(r,i)=>(r.add(i),r),r=>[...r]),t}var qt="gSVGObject",Mn="http://www.w3.org/2000/svg",_n="svg",Bt="d",Oe="transform",Me="appendChild",zt="insertBefore",ve="insertAdjacentElement",_e="attach",Le="innerHTML",Ht=new WeakMap,Gt=new Set,Ln=t=>se(t)||t.startsWith("_")||["el","gSVG","then"].includes(t),In=()=>qt+Math.random().toString(32).substring(2),Wt=t=>E(t)&&!b(t)&&t[Symbol.toStringTag]===qt,Pn=t=>Et(document.createElementNS(Mn,t)),dt=t=>N(t)?Pn(t):E(t)&&t!==null?Wt(t)?t:Et(t):t,Un=t=>({content:Le,source:"outerHTML",parent:"parentElement",next:"nextElementSibling",previous:"previousElementSibling",add:Me,addBefore:zt})[t]||t,Dn=t=>["append","before","after",Me,zt,ve].includes(t)?function(...e){let n=[],r=[],i=[];return t===ve?(n.push(e[0]),r.push(dt(e[1]))):t===zt?(r.push(dt(e[0])),i.push(e[1]||this.firstChild||null)):r.push(...e.map(dt)),r.every(c=>c?._el)?(this[t](...n,...r.map(c=>c._el),...i),r.forEach(c=>c._el.dispatchEvent(new Event(_e))),r.length>1?r:r[0]):null}:null,yt=class{constructor(e){this._el=e,this.gSVG=z}get[Symbol.toStringTag](){return qt}get el(){return this._el}attachTo(e){return(E(e)?Wt(e)?e._el:e:document.querySelector(e)).appendChild(this._el),this._el.dispatchEvent(new Event(_e)),this}id(e){return e?(this._el.setAttribute("id",e),this):this._el.id||(this._el.id=In())}ref(){return`#${this.id()}`}url(){return`url(${this.ref()})`}parents(){let e=[],n=this;for(;n=n.parentElement();)e.push(n);return e}top(){return this.parents().pop()||this}},Et=t=>{if(!E(t)||b(t))return null;if(Ht.has(t))return Ht.get(t);let e=new Proxy(new yt(t),{get(n,r){if(Ln(r))return n[r];if(!g(n[r]))return(...o)=>(D(e,r,o),n[r].call(e,...o));if([Bt,Oe,"$"+Bt,"$"+Oe].includes(r)){let o="";r[0]==="$"&&(r=r.substring(1));let u=r===Bt?Fn:Vn,l=new Proxy(d=>(D(e,r,[d]),g(d)?t.getAttribute(r):(d?t.setAttribute(r,d):t.removeAttribute(r),e)),{get(d,h){return h in d?Reflect.get(d,h):(...w)=>{if(h===Symbol.toPrimitive){let P=o;return o="",P}return o+=u(e,h,w),t?.setAttribute(r,o),l}}});return l}let i=Un(r),c=Dn(i)||t[i];return f(c)?(...o)=>{D(e,r,o);let s=c.call(t,...o);return g(s)?e:Pe(s)}:Ie(t,i,e)}});return Ht.set(t,e),e},Ie=(t,e,n,r)=>{let i=e.replace(/_/g,"-"),c=(...o)=>{if(D(n,r?`${r}.${e}`:e,o),o.length===0){let u=t?.hasAttribute&&t.hasAttribute(i)?t.getAttribute(i):t[i];return Pe(u)}let s=o[0];if(W(t,CSSStyleDeclaration))return t[i]=s,n;if(i in t&&!Gt.has(i)){let u=t[i];if(String(u)===String(s))return n;try{t[i]=s}catch{Gt.add(i)}if(E(t[i])&&t[i]===s||t[i]!==u||i===Le)return n;Gt.add(i)}return s!==0&&!s?t?.removeAttribute&&t.removeAttribute(i):t?.setAttribute&&t.setAttribute(i,oe(s)?"":String(o)),n};return new Proxy(c,{get(o,s){let u=t[i][s];return f(u)?(...l)=>(D(n,`${e}.${s}`,l),u.call(t[i],...l)||n):Ie(t[i],s,n,i)},set(o,s,u){return t[i][s]=u,!0}})},Pe=t=>W(t,HTMLCollection)||W(t,NodeList)?[...t].map(e=>Et(e)):W(t,SVGElement)?Et(t):N(t)?t===""||isNaN(t)?t:Number(t):t,Ue=[],D=(t,e,n,r=[])=>{for(let i of Ue)i(z,t,e,n,r)},pt={},Fn=(t,e,n)=>(D(t,`d.${e}`,n,Object.keys(pt).map(r=>`d.${r}`)),pt[e]?pt[e].apply(t,n):`${e}${n.join(",")}`),Vn=(t,e,n)=>(D(t,`transform.${e}`,n),`${e}(${n.join(",")})`);function z(t){return D(null,"",[t]),dt(g(t)?_n:t)}z.isWrapped=Wt;var mt=t=>e=>f(e)?e(t):Object.assign(t,e),Yt={install:De,extendConstructor:mt(z),extendInstance:mt(yt.prototype),extendPath:mt(pt),beforeEveryCall(t){f(t)&&Ue.push(t)}};Yt.extendSetup=mt(Yt);function De(t){return t(Yt),z}z.install=De;var rt=z;var Jt="animate",kn="path",Fe="d",Ve="transform",Bn="rotate",K="translate",ke="inherit",Be="finished",Hn=t=>/^(rotate|skewX|skewY)$/.test(t),Gn=t=>/^(translate|width|height|x|y|cx|cy|r|rx|ry|dx|dy)$/.test(t),zn=(t,e)=>t&&/^(text|tspan)$/.test(t)&&/^([xy])$/.test(e),Xt=!1;if(window.matchMedia){let t=window.matchMedia("(prefers-reduced-motion: reduce)");Xt=t.matches,t.addEventListener("change",()=>{Xt=t.matches})}var Yn=t=>t.replace(/([A-Z])/g,"-$1").toLowerCase();function qn(t,e={duration:200},n=null,r=null){let i=this.gSVG,c=a=>{let m=E(a)?{...a}:{duration:a};return Xt&&(m.duration=0),m.fill="none",m},o=a=>{a=I(a)?a:[a];let m=window.getComputedStyle(this._el),y=[],p=new Set;for(let S of a){let x={};for(let V in S){let O=ot(V);x[O]=h(S[V],O),!(O in m)||zn(this.tagName(),O)?p.add(O):O===Fe?x.d=`${kn}("${x.d}")`:O===Ve&&(x.transform=l(x.transform))}y.push(x)}return u(p,y),y},s=[],u=(a,m)=>{if(a.size){let y=new KeyframeEffect(null,m).getKeyframes();for(let p of a){let S=i(Jt).attributeName(p).dur(tt.duration+"ms").fill("freeze").begin("indefinite");if(m.length===1)S.to(m[0][p]);else{let x=[],V=[];for(let O in y){let sn=y[O];p in m[O]&&(x.push(sn.computedOffset),V.push(m[O][p]))}x[0]!==0&&(x.unshift(0),V.unshift(this[p]()||ke)),x[x.length-1]!==1&&(x.push(1),V.push(this[p]()||ke)),S.keyTimes(x.join(";")).values(V.join(";"))}s.push(S),S.attachTo(this),S.beginElementAt((tt.delay||0)/1e3)}}},l=a=>{N(a)&&(a=JSON.parse("{"+a.trim().replace(/^(\w+)\s*\(\s*([^)]+)\s*\)\s*$/,(y,p,S)=>`"${p}": [${S.trim().split(/\s*,\s*|\s+/).map(x=>/^[-+]?\d+(?:\.\d+)?$/.test(x)?x:`"${x}"`).join(", ")}]`)+"}"));let m="";for(let y in a)if(y===Bn){let p=d(a[y]);p.length>1&&(m+=`${K}(${h(p[1],K)},${h(p[2],K)}) `),m+=`${y}(${h(p[0],y)}) `,p.length>1&&(m+=`${K}(-${h(p[1],K)},-${h(p[2],K)}) `)}else m+=`${y}(${d(a[y]).map(p=>h(p,y)).join(",")}) `;return m},d=a=>I(a)?a:String(a).split(/\s+|,/),h=(a,m)=>N(a)&&/deg|px/.test(a)?a:Hn(m)?a+"deg":Gn(m)?a+"px":a,w=a=>N(a)?a.replace(/(deg)|(px)/g,"").trim():a,P=a=>a.replace(/(path\s*\(\s*["'])|(["']\s*\)\s*$)/g,"").trim().replace(/([a-zA-Z])\s*/g,"$1").replace(/\s+/g,","),Tt=a=>{let m=/translate\((.*)px,(.*)px\) rotate\((.*)deg\) translate\((.*)px,(.*)px\)\s+/,y=m.exec(a);return y&&Number(y[1])===Number(y[4])*-1&&Number(y[2])===Number(y[5])*-1?a=a.replace(m,`rotate(${y[3]}, ${y[1]}, ${y[2]})`):a=w(a),a},tt=c(e),U=o(t),Y=this._el.animate(U,tt);return Y.ready.then(()=>f(n)&&n.call(this,Y)),Y.finished.then(()=>{let a=U[U.length-1];for(let p in a){let S=Yn(p);S.startsWith("text-")?this._el.style[p]=a[p]:p!=="offset"&&p in a&&this._el.setAttribute(S,S===Fe?P(a[p]):S===Ve?Tt(a[p]):w(a[p]))}s.forEach(p=>p[Be](!0));let m=this._el.querySelectorAll(Jt),y=this._el.querySelectorAll(`${Jt}[${Be}]`);m.length===y.length&&m.forEach(p=>p.remove()),f(r)&&r.call(this,Y)}),this}function Wn(t){t.extendInstance({animateTo:qn})}var He=Wn;var $t={},Ge=Symbol(),Je=Symbol(),_=Symbol(),Z=Symbol(),gt=Symbol(),Zt=Symbol(),ze=Symbol(),Kt="error",Jn="unknown",Ye='an invalid "g-for" expression',Xn="undefined",Kn="NaN (Not a Number)",Nt=(t,e)=>new Error(`The expression "${t}" return ${e} value`),qe="class",We="style",Zn=(t,e,n)=>{throw new Error(t+` in ${e} `+n)},Qn=(t=>e=>t[e]||e)("attributeName attributeType baseFrequency calcMode clipPathUnits diffuseConstant edgeMode gradientTransform gradientUnits kernelMatrix kernelUnitLength lengthAdjust limitingConeAngle markerHeight markerUnits markerWidth maskContentUnits maskUnits numOctaves pathLength patternContentUnits patternTransform patternUnits pointsAtX pointsAtY pointsAtZ preserveAlpha preserveAspectRatio primitiveUnits refX refY requiredExtensions requiredFeatures specularConstant specularExponent spreadMethod startOffset stdDeviation stitchTiles surfaceScale systemLanguage tableValues targetX targetY textLength viewBox xChannelSelector yChannelSelector zoomAndPan".split(" ").reduce((t,e)=>(t[e.toLowerCase()]=e,t),{}));function Xe(t){if(!t?.el?.parentNode)return null;let e=document.createComment(" ref ");return t.parentNode().insertBefore(e,t.el),t.remove(),e[Zt]=t,e}function Ke(t){try{return new Function(`let ${t} = 0`),!0}catch{return!1}}function jn(t){let e=t[Zt];return t.parentNode.insertBefore(e.el,t),t.remove(),e}Q({name:"g-content",exec(t,{expr:e,data:n,evalExpr:r}){let i={...n,$$:{fromURL:async u=>{let l=await fetch(u);if(l.status===200)return l.text();console.warn(`Failed to load URL: ${u} (${l.status})`)},element:t,currentContent:t.content,...n.$||{}}};i.$=i.$$;let c=r(e,i),o=new CustomEvent("load",{bubbles:!0,detail:t}),s=u=>g(u)?"":u;E(c)&&c.then?c.then(u=>{t.content(s(u)),t.dispatchEvent(o)}):(t.content(s(c)),t.dispatchEvent(o))}});Q({name:"g-if",exec(t,{expr:e,data:n,evalExpr:r}){if(!r(e,n))return t[_]&&(t[_].forEach(i=>i.remove()),delete t[_]),Xe(t)}});Q({name:"g-bind",alias:":",arg:!0,exec(t,{expr:e,arg:n,data:r,evalExpr:i}){n=Qn(n);let c=t._el,o={...r,$$:["d","transform"].includes(n)?t["$"+n]:{}};Object.assign(o.$$,{get element(){return t},get attribute(){return n},currentValue(){return n===qe?[...c.classList]:n===We?[...c.style].reduce((u,l)=>(u[l]=c.style[l],u),{}):t[n]()},dynamic(u,l=200,d=0){return t.animateTo((I(u)?u:[u]).map(h=>E(h)&&"offset"in h?{[n]:h.value,offset:h.offset}:{[n]:h}),{duration:l,delay:d}),ze},...r.$||{}}),o.$=o.$$;let s=i(e,o);if(g(s))throw Nt(e,Xn);if(n===qe){let u=h=>t.classList.add(h),l=h=>t.classList.remove(h),d=h=>Object.entries(h).forEach(([w,P])=>P?u(w):l(w));if(I(s)){s.forEach(h=>N(h)?u(h):E(h)?d(h):void 0);return}if(E(s)){d(s);return}s&&u(s);return}if(n===We){Object.entries(s).forEach(([u,l])=>t.style[u](l));return}s!==ze&&t[n](s)}});Q({name:"g-on",alias:"@",arg:!0,exec(t,{expr:e,arg:n,data:r,evalExpr:i,error:c,code:o}){t[gt]=t[gt]||{};let s=t[gt][n]=t[gt][n]||new Map;s.has(e)&&t.removeEventListener(n,s.get(e));let u=function(l){try{let d=i(e,r,t);f(d)&&d.call(t,l)}catch(d){c(d.message,{directive:"g-on",argument:n,expression:e,toString(){return`g-on:${n}="${e}"`}},o)}};t.addEventListener(n,u),s.set(e,u),n==="init"&&!t[Ge]&&(t[Ge]=!0,t.dispatchEvent(new Event("init")))}});Q({name:"g-for",tmpl:!0,exec(t,{expr:e,data:n,error:r}){t[_]=t[_]||[];let i=t.gSVG(Xe(t)),c=0;return rr(e,n,o=>{if(t[_][c])it(t[_][c],o,r,!1);else{let s=t.gSVG(t.tagName());s[Z]=t[Z].filter(u=>u.name!=="g-for"),[...t.attributes()].forEach(u=>{u.name!=="g-for"&&s.setAttribute(u.name,u.value)}),t.children().forEach(u=>{s.add(u.cloneNode(!0))}),i.before(s),it(s,o,r),s[Je]=!0,t[_].push(s)}c++},o=>{for(;t[_].length>o.length;)t[_].pop().remove()}),!0}});function Q({name:t,alias:e,arg:n,tmpl:r,exec:i}){let c=`^(${t}${n?":":""}${e?`|${e})`:")"}${n?"(.*)$":"$"}`,o=new RegExp(c,"i");$t[t]={name:t,alias:e,arg:n,tmpl:r,exec:i,check:o}}function tr(t){for(let e in $t){let n=$t[e],r=n.check.exec(t);if(r){let i=r[2];return{...n,arg:i}}}}function er(t){return t.replace(/[{}()[\]]/g,"").split(",").map(e=>(e.includes(":")?e.split(":")[1].trim():e).trim())}function nr(t,e){return t[Symbol.iterator]?e==="of"?{iterator:[...t],type:q}:{type:Kt}:ie(t)?{iterator:Array(t<0?0:0|t).fill(0).map((n,r)=>r+(e==="of"?0:1)),type:v}:E(t)?e==="in"?{iterator:Object.entries(t).map(n=>n.reverse()),type:A}:{type:Kt}:{iterator:t,type:Jn}}function Ze(t,e,n=null){let r=Object.keys(e).filter(Ke),c=ht(r,`return ( ${t} ); `).apply(n,r.map(o=>e[o]));if(!st(c))throw Nt(t,Kn);return c}function rr(t,e,n,r){let i="__$$i",c="__$$c",o="__$$f",s=t.match(/^\s*([\s\S]+?)[\s*|)}\]](of|in)[\s*|({[]([\s\S]+?)\s*$/);if(!s)throw Nt(t,Ye);let[,u,l,d]=s;l=l.trim(),u=u.trim(),d=d.trim();let h=Ze(d,e)||[],{iterator:w,type:P}=nr(h,l);if(P===Kt)throw Nt(t,Ye);P===A&&!u.startsWith("[")&&(u=`[${u.replace(/(^\()|(\)$)/g,"")}]`);let Tt=er(u),tt=u.startsWith("(")?u:`(${u})`,U=Object.keys(e).filter(Ke),Y=` ${i}.forEach(${tt} => { ${c}({${U}${U.length?",":""}${Tt.join(",")}}); }); ${o}(${i}); `;return ht([...U,i,c,o],Y)(...U.map(m=>e[m]),w,n,r)}function it(t,e,n,r=!0){if(r&&t[Je])return;let i=t.outerHTML();t[Z]=t[Z]||[];let c=t.attributes();for(let s of[...c]){let u=s.name,l=tr(u);l&&(t[Z].push({...l,expr:s.value}),t.removeAttribute(u))}let o=!1;for(let s of t[Z]){o=s.tmpl||o;try{if(s.exec(t,{...s,data:e,evalExpr:Ze,error:n,code:i}))return}catch(u){n(u.message,{directive:s.name,argument:s.arg,expression:s.expr,toString(){return`${s.name}${s.arg?":"+s.arg:""}="${s.expr}"`}},i)}}if(!o)for(let s of t.childNodes())s.el[Zt]?it(jn(s.el),e,n):s.el?.nodeType===1&&it(s,e,n)}function ir(t={},e=Zn){it(this,t,e),this.dispatchEvent(new Event("render"))}function sr(){return this.outerHTML().replaceAll("<!-- ref -->","")}function or(t){t.install(He),t.extendInstance({render:ir,source:sr}),t.extendSetup({extendTemplate:{defineDirective:Q,getDirective(e){return $t[e]}}})}var Qe=or;var je=t=>Math.round(t*1e4)/1e4;function Qt(t){return(t-90)*Math.PI/180}function xt(t,e,n,r){let i=Qt(r);return{x:je(t+n*Math.cos(i)),y:je(e+n*Math.sin(i))}}function St(t,e,n,r,i=0){i=Math.abs(i)>=360?i%360:i,r=Math.abs(r)>360?r%360:r,r=Math.abs(r)===360?r>0?359.9:-359.9:r;let c=i+r,o=r>0?1:0,s=Math.abs(c-i)<=180?0:1,u=i<0?(360+i)%360:i,l=c<0?(360+c)%360:c,d=xt(t,e,n,u),h=xt(t,e,n,l);return`M${d.x},${d.y}A${n},${n},0,${s},${o},${h.x},${h.y}`}function cr(t,e,n,r,i,c=0){let o=St(t,e,n+r/2,i,c),s=St(t,e,n-r/2,-i,c+i);return o+"L"+s.substring(1)+"Z"}function ur(t,e,n,r,i=0){return`${St(t,e,n,r,i)}L${t},${e}Z`}function ar(t){t.extendConstructor({polar2cartesian:xt,degrees2radians:Qt}),t.extendview&&t.extendview({polar2cartesian:xt,degrees2radians:Qt}),t.extendPath({arc:St,barArc:cr,circleSlice:ur})}var tn=ar;var jt="update",j="svg",te="methods",ee="config",ne="data",At="-src",en=t=>`script[type=${t}],g-script[type=${t}]`,nn=["0px","auto"],lr=t=>{let e=getComputedStyle(t.el);return nn.includes(e.width)&&nn.includes(e.height)},rn=t=>({get svg(){return t.svg},get data(){return t.data},get config(){return t.config},get methods(){return t.methods},polar2cartesian:t.polar2cartesian,degrees2radians:t.degrees2radians,grapperView:t}),F=class extends M{static install(e){rt.install(e)}#t=null;#r=!1;#i=!1;#s=[];#e=[];#h=vt(function(e,n){this[T](e,n)},1);#n(e,n,r,i){let c={message:e,scope:n,code:r,toString:()=>`${e}${n?` in ${n}`:""} ${r}`};i.push(c),console.warn(`Grapper view - Error: ${c}`),this.#h.call(this,"error",this.errors)}#d(e){return e.length=0,(n,r="",i="")=>this.#n(n,r,i,this.#s)}async#c(e){let n=await fetch(e);if(n.status!==200)throw new Error(`${n.statusText} (${n.status}): ${n.url}`);return n.text()}async#p(){let e=[...this.querySelectorAll(en("plugin"))];for(let n of e){let r=n.getAttribute("src");if(r){let i=new URL(r,document.location.href);try{let c=await import(i.href);c?.default&&rt.install(c.default)}catch(c){this.#n(c.message,"plugin",r,this.#e)}}}}async#u(){let e=this[$];if(this.#t=null,e.content.innerHTML="",e.svgSrc)try{e.content.innerHTML=await this.#c(e.svgSrc)}catch(r){this.#n(r.message,j,e.svgSrc,this.#e)}else{let r=this.querySelector("template")?.content||this.querySelector(j);r&&e.content.append(r.cloneNode(!0))}let n=e.content.querySelector(j);return this.#t=n?rt(n):null,!0}async#o(e,n){let r=this[$],i=e+"Src",c=this.querySelector(en(e));c&&(r[i]=c.getAttribute("src"));let o=r[i]?await this.#c(r[i]).catch(s=>this.#n(s.message,e,r[i],this.#e)):c?.textContent;if(o)try{r[e]=n(o)}catch(s){this.#n(s.message,e,o,this.#e)}}#a(){return this.#o(te,e=>be({$:rn(this)},e))}#l(){return this.#o(ee,bt)}#f(){return this.#o(ne,e=>ue(e)||ae(e)?bt(e):le(e))}constructor(){super();let e=this[$];this.shadowRoot.innerHTML=` <style> :host { display : inline-block; width : max-content; height : max-content; } </style><span></span>`,e.content=this.shadowRoot.querySelector("span")}[R](){return!this.load()}async[G](e){let n=[];for(let r of e){let i=r.target;if(i===this&&!r.attributeName)return this.load();if(i.tagName.toLowerCase()===j)n.push(this.#u());else if(i.tagName==="SCRIPT"){let c={data:this.#f,methods:this.#a,config:this.#l}[i.type.toLowerCase()];c&&n.push(c())}}if(n.length)return await Promise.all(n),this.update()}async load(){return this.#r=!1,this.#e=[],await this.#p(),await Promise.all([this.#u(),this.#l(),this.#a(),this.#f()]),this.#r=!0,this[T]("load"),this.update(!0)}async update(e=!1){if(!(this.#i&&!e)&&this.#t){this.rendered=!1,this.#i=!0;let n=this[$],r=n.methods?.data?n.methods.data(kt(H(n.data))):kt(H(n.data)),i={...n.methods,...I(r)?{}:r,data:r,$:rn(this)};await this.#t.render(i,this.#d(this.#s)),lr(this.#t)&&this.#t.width("100%").height("100%"),this.#i=!1,this.rendered=!0}}get[j](){return this.#t}get loaded(){return this.#r}get errors(){return[...this.#e,...this.#s]}get version(){return"1.1.0-beta.6"}};F.prototype.update=vt(F.prototype.update,1);xe(F).ext(we).attr({name:j+At,type:C,value:"",posUpdate:R}).attr({name:ne,type:A,value:[],posUpdate:jt}).attr({name:ne+At,type:C,posUpdate:R}).prop({name:te,type:A,value:{},posUpdate:jt}).attr({name:te+At,type:C,posUpdate:R}).attr({name:ee,type:A,value:{},posUpdate:jt}).attr({name:ee+At,type:C,posUpdate:R}).attr({name:"value",set(t){this.data={value:t}},get(){return this.data?.value}}).tag("grapper-view").alias("g-composer");var fr=t=>{t.extendSetup({extendview(e){f(e)?e(F.prototype):Object.assign(F.prototype,e)}})};rt.install(fr).install(Qe).install(tn);})();